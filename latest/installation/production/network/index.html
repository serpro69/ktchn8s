<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://serpro69.github.io/ktchn8s/latest/installation/production/network/ rel=canonical><link href=../ rel=prev><link href=../external/ rel=next><link rel=icon href=../../../assets/images/favicon_io_logo_6/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.2"><title>Network Configuration - ktchn8s</title><link rel=stylesheet href=../../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/stylesheets/image.css><link rel=stylesheet href=../../../assets/stylesheets/extra.css><link rel=stylesheet href=../../../assets/stylesheets/nord.css><link rel=stylesheet href=../../../assets/stylesheets/panzoom.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta name="panzoom-theme" content="material">
<meta name="panzoom-data" content='{"selectors": [".mermaid", ".d2"], "initial_zoom_level": 1.0}'> </head> <body dir=ltr data-md-color-scheme=nord:light data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#network-configuration class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=ktchn8s class="md-header__button md-logo" aria-label=ktchn8s data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13.95 13.5h-.23c-.18.11-.26.32-.18.5l.86 2.11c.83-.53 1.46-1.32 1.79-2.25l-2.23-.36zm-3.45.29a.415.415 0 0 0-.38-.29h-.08l-2.22.37c.33.92.96 1.7 1.79 2.23l.85-2.07V14c.04-.05.04-.14.04-.21m1.83.81a.38.38 0 0 0-.51-.15c-.07.05-.12.08-.15.15h-.01l-1.09 1.97c.78.26 1.62.31 2.43.12.14-.03.29-.07.43-.12l-1.09-1.97zm3.45-4.57L14.1 11.5l.01.03a.37.37 0 0 0-.04.53q.075.09.18.12l.01.01 2.17.62c.07-.97-.14-1.95-.65-2.78m-3.11.16c.01.21.18.37.39.36.08 0 .15-.02.21-.05h.01l1.83-1.31a4.45 4.45 0 0 0-2.57-1.24zm-1.94.31c.17.11.4.08.52-.09.05-.06.07-.13.08-.21h.01l.12-2.25c-.15.02-.3.05-.46.08-.8.18-1.54.58-2.12 1.16l1.84 1.31zm-.99 1.69c.2-.05.32-.26.26-.46 0-.08-.05-.14-.11-.19v-.01L8.21 10c-.52.86-.74 1.84-.63 2.82l2.16-.62zm1.64.66.62.3.62-.3.15-.67-.43-.53h-.69l-.43.53zm10.89 1.32L20.5 6.5c-.09-.42-.37-.76-.74-.94l-7.17-3.43c-.37-.17-.81-.17-1.19 0L4.24 5.56c-.37.18-.65.52-.74.94l-1.77 7.67c-.05.2-.05.4 0 .59.01.06.03.12.05.18.03.09.08.19.13.27.03.04.05.08.09.11l4.95 6.18c.02 0 .05.04.05.06.1.09.19.16.28.22.12.08.26.14.4.17.11.05.23.05.32.05h8.12c.07 0 .14-.03.2-.05.05-.01.1-.03.14-.04.04-.02.07-.03.11-.05.05-.02.1-.05.15-.08.12-.08.23-.18.33-.28l.15-.2 4.8-5.98c.1-.12.17-.25.22-.38.02-.06.04-.12.05-.18.05-.19.05-.4 0-.59m-7.43 2.99c.02.06.04.12.07.17-.04.08-.06.17-.03.26.12.24.23.46.38.68.08.11.16.23.24.34 0 .03.03.08.04.12.12.2.06.46-.15.59s-.47.05-.59-.15c-.01-.03-.02-.05-.03-.08-.02-.03-.04-.09-.06-.09-.05-.15-.09-.28-.12-.41-.09-.25-.17-.49-.3-.72a.38.38 0 0 0-.21-.14l-.08-.16c-1.29.48-2.7.48-3.97-.01l-.1.18c-.07.01-.14.04-.19.09-.14.24-.24.49-.33.77-.03.13-.07.26-.12.4-.02 0-.04.07-.06.1a.43.43 0 0 1-.81-.29c.01-.03.03-.05.04-.08.04-.03.04-.08.04-.11.09-.12.16-.23.24-.35.16-.21.29-.45.39-.69a.54.54 0 0 0-.03-.25l.07-.18a5.6 5.6 0 0 1-2.47-3.09l-.2.03a.4.4 0 0 0-.23-.09c-.27.05-.51.13-.77.22-.11.06-.24.11-.37.15-.03.01-.07.02-.13.03a.44.44 0 0 1-.54-.27c-.07-.23.04-.47.28-.55.02 0 .05-.01.08-.01v-.01h.01l.11-.02c.14-.04.28-.04.41-.04.26 0 .52-.06.77-.12.08-.05.14-.11.19-.19l.19-.05c-.21-1.36.1-2.73.86-3.87l-.14-.12c0-.09-.03-.18-.08-.25-.2-.17-.41-.32-.64-.45q-.18-.09-.36-.21c-.02-.02-.06-.05-.08-.07l-.01-.01c-.2-.16-.25-.42-.11-.63.09-.1.21-.15.35-.15q.165.015.3.12l.09.07c.1.09.19.2.28.3.18.19.37.37.58.52.08.04.17.05.26.03l.15.11c.75-.8 1.73-1.36 2.8-1.6.25-.06.52-.1.78-.12l.01-.18a.45.45 0 0 0 .14-.23c.01-.26-.01-.52-.05-.77-.03-.13-.05-.27-.06-.41V5.1c-.02-.24.15-.45.39-.48s.44.15.47.38v.22c-.01.14-.03.28-.06.41-.04.25-.06.51-.05.77.02.1.07.17.14.22l.01.19c1.36.12 2.62.73 3.56 1.72l.16-.12c.09.02.18.01.26-.03.21-.15.41-.33.58-.52.09-.1.18-.2.28-.3.03-.02.07-.06.1-.06.17-.18.44-.18.59 0 .19.16.18.43 0 .6 0 .02-.03.04-.06.06a2.495 2.495 0 0 1-.44.28c-.23.13-.45.28-.64.45-.06.07-.09.15-.08.24l-.16.14a5.44 5.44 0 0 1 .88 3.86l.19.05c.04.08.11.14.19.18.25.07.51.11.77.14h.41c.03.03.08.04.12.05.24.03.4.25.37.49-.05.23-.24.4-.48.37-.03-.01-.07-.01-.07-.02v-.01c-.06 0-.1-.01-.14-.02q-.195-.06-.36-.15c-.26-.1-.5-.17-.77-.21-.09 0-.17 0-.23.08-.07-.01-.13-.02-.19-.03-.41 1.31-1.31 2.41-2.47 3.11"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ktchn8s </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Network Configuration </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=nord:light data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=nord:dark data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/serpro69/ktchn8s title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> ~/ </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> ☲ Installation </a> </li> <li class=md-tabs__item> <a href=../../../concepts/ class=md-tabs__link> ☰ Concepts </a> </li> <li class=md-tabs__item> <a href=../../../reference/architecture/ class=md-tabs__link> ☵ Referece </a> </li> <li class=md-tabs__item> <a href=../../../guides/ class=md-tabs__link> ☷ Guides </a> </li> <li class=md-tabs__item> <a href=../../../info/ class=md-tabs__link> ⛬ Info </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=ktchn8s class="md-nav__button md-logo" aria-label=ktchn8s data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13.95 13.5h-.23c-.18.11-.26.32-.18.5l.86 2.11c.83-.53 1.46-1.32 1.79-2.25l-2.23-.36zm-3.45.29a.415.415 0 0 0-.38-.29h-.08l-2.22.37c.33.92.96 1.7 1.79 2.23l.85-2.07V14c.04-.05.04-.14.04-.21m1.83.81a.38.38 0 0 0-.51-.15c-.07.05-.12.08-.15.15h-.01l-1.09 1.97c.78.26 1.62.31 2.43.12.14-.03.29-.07.43-.12l-1.09-1.97zm3.45-4.57L14.1 11.5l.01.03a.37.37 0 0 0-.04.53q.075.09.18.12l.01.01 2.17.62c.07-.97-.14-1.95-.65-2.78m-3.11.16c.01.21.18.37.39.36.08 0 .15-.02.21-.05h.01l1.83-1.31a4.45 4.45 0 0 0-2.57-1.24zm-1.94.31c.17.11.4.08.52-.09.05-.06.07-.13.08-.21h.01l.12-2.25c-.15.02-.3.05-.46.08-.8.18-1.54.58-2.12 1.16l1.84 1.31zm-.99 1.69c.2-.05.32-.26.26-.46 0-.08-.05-.14-.11-.19v-.01L8.21 10c-.52.86-.74 1.84-.63 2.82l2.16-.62zm1.64.66.62.3.62-.3.15-.67-.43-.53h-.69l-.43.53zm10.89 1.32L20.5 6.5c-.09-.42-.37-.76-.74-.94l-7.17-3.43c-.37-.17-.81-.17-1.19 0L4.24 5.56c-.37.18-.65.52-.74.94l-1.77 7.67c-.05.2-.05.4 0 .59.01.06.03.12.05.18.03.09.08.19.13.27.03.04.05.08.09.11l4.95 6.18c.02 0 .05.04.05.06.1.09.19.16.28.22.12.08.26.14.4.17.11.05.23.05.32.05h8.12c.07 0 .14-.03.2-.05.05-.01.1-.03.14-.04.04-.02.07-.03.11-.05.05-.02.1-.05.15-.08.12-.08.23-.18.33-.28l.15-.2 4.8-5.98c.1-.12.17-.25.22-.38.02-.06.04-.12.05-.18.05-.19.05-.4 0-.59m-7.43 2.99c.02.06.04.12.07.17-.04.08-.06.17-.03.26.12.24.23.46.38.68.08.11.16.23.24.34 0 .03.03.08.04.12.12.2.06.46-.15.59s-.47.05-.59-.15c-.01-.03-.02-.05-.03-.08-.02-.03-.04-.09-.06-.09-.05-.15-.09-.28-.12-.41-.09-.25-.17-.49-.3-.72a.38.38 0 0 0-.21-.14l-.08-.16c-1.29.48-2.7.48-3.97-.01l-.1.18c-.07.01-.14.04-.19.09-.14.24-.24.49-.33.77-.03.13-.07.26-.12.4-.02 0-.04.07-.06.1a.43.43 0 0 1-.81-.29c.01-.03.03-.05.04-.08.04-.03.04-.08.04-.11.09-.12.16-.23.24-.35.16-.21.29-.45.39-.69a.54.54 0 0 0-.03-.25l.07-.18a5.6 5.6 0 0 1-2.47-3.09l-.2.03a.4.4 0 0 0-.23-.09c-.27.05-.51.13-.77.22-.11.06-.24.11-.37.15-.03.01-.07.02-.13.03a.44.44 0 0 1-.54-.27c-.07-.23.04-.47.28-.55.02 0 .05-.01.08-.01v-.01h.01l.11-.02c.14-.04.28-.04.41-.04.26 0 .52-.06.77-.12.08-.05.14-.11.19-.19l.19-.05c-.21-1.36.1-2.73.86-3.87l-.14-.12c0-.09-.03-.18-.08-.25-.2-.17-.41-.32-.64-.45q-.18-.09-.36-.21c-.02-.02-.06-.05-.08-.07l-.01-.01c-.2-.16-.25-.42-.11-.63.09-.1.21-.15.35-.15q.165.015.3.12l.09.07c.1.09.19.2.28.3.18.19.37.37.58.52.08.04.17.05.26.03l.15.11c.75-.8 1.73-1.36 2.8-1.6.25-.06.52-.1.78-.12l.01-.18a.45.45 0 0 0 .14-.23c.01-.26-.01-.52-.05-.77-.03-.13-.05-.27-.06-.41V5.1c-.02-.24.15-.45.39-.48s.44.15.47.38v.22c-.01.14-.03.28-.06.41-.04.25-.06.51-.05.77.02.1.07.17.14.22l.01.19c1.36.12 2.62.73 3.56 1.72l.16-.12c.09.02.18.01.26-.03.21-.15.41-.33.58-.52.09-.1.18-.2.28-.3.03-.02.07-.06.1-.06.17-.18.44-.18.59 0 .19.16.18.43 0 .6 0 .02-.03.04-.06.06a2.495 2.495 0 0 1-.44.28c-.23.13-.45.28-.64.45-.06.07-.09.15-.08.24l-.16.14a5.44 5.44 0 0 1 .88 3.86l.19.05c.04.08.11.14.19.18.25.07.51.11.77.14h.41c.03.03.08.04.12.05.24.03.4.25.37.49-.05.23-.24.4-.48.37-.03-.01-.07-.01-.07-.02v-.01c-.06 0-.1-.01-.14-.02q-.195-.06-.36-.15c-.26-.1-.5-.17-.77-.21-.09 0-.17 0-.23.08-.07-.01-.13-.02-.19-.03-.41 1.31-1.31 2.41-2.47 3.11"/></svg> </a> ktchn8s </label> <div class=md-nav__source> <a href=https://github.com/serpro69/ktchn8s title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> ~/ </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> ☲ Installation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> ☲ Installation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> ☱ Production </span> </a> <label class="md-nav__link " for=__nav_2_1 id=__nav_2_1_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=true> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> ☱ Production </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 2c-1.11 0-2 .89-2 2v3c0 1.11.89 2 2 2h1v2H2v2h4v2H5c-1.11 0-2 .89-2 2v3c0 1.11.89 2 2 2h4c1.11 0 2-.89 2-2v-3c0-1.11-.89-2-2-2H8v-2h8v2h-1c-1.11 0-2 .89-2 2v3c0 1.11.89 2 2 2h4c1.11 0 2-.89 2-2v-3c0-1.11-.89-2-2-2h-1v-2h4v-2h-9V9h1c1.11 0 2-.89 2-2V4c0-1.11-.89-2-2-2zm0 2h4v3h-4zM5 17h4v3H5zm10 0h4v3h-4z"/></svg> <span class=md-ellipsis> Network Configuration </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 2c-1.11 0-2 .89-2 2v3c0 1.11.89 2 2 2h1v2H2v2h4v2H5c-1.11 0-2 .89-2 2v3c0 1.11.89 2 2 2h4c1.11 0 2-.89 2-2v-3c0-1.11-.89-2-2-2H8v-2h8v2h-1c-1.11 0-2 .89-2 2v3c0 1.11.89 2 2 2h4c1.11 0 2-.89 2-2v-3c0-1.11-.89-2-2-2h-1v-2h4v-2h-9V9h1c1.11 0 2-.89 2-2V4c0-1.11-.89-2-2-2zm0 2h4v3h-4zM5 17h4v3H5zm10 0h4v3h-4z"/></svg> <span class=md-ellipsis> Network Configuration </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#hardware-requirements class=md-nav__link> <span class=md-ellipsis> Hardware Requirements </span> </a> </li> <li class=md-nav__item> <a href=#serial-console-connection class=md-nav__link> <span class=md-ellipsis> Serial Console Connection </span> </a> <nav class=md-nav aria-label="Serial Console Connection"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#software class=md-nav__link> <span class=md-ellipsis> Software </span> </a> </li> <li class=md-nav__item> <a href=#steps class=md-nav__link> <span class=md-ellipsis> Steps </span> </a> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> <span class=md-ellipsis> References </span> </a> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class=md-nav aria-label=Troubleshooting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#screen-is-terminating-error class=md-nav__link> <span class=md-ellipsis> [screen is terminating] error </span> </a> </li> <li class=md-nav__item> <a href=#no-slow-console-output class=md-nav__link> <span class=md-ellipsis> No (slow) console output </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#configuration-rollout class=md-nav__link> <span class=md-ellipsis> Configuration Rollout </span> </a> <nav class=md-nav aria-label="Configuration Rollout"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#stage-1 class=md-nav__link> <span class=md-ellipsis> Stage 1 - Basic Internet Connectivity via C1111 and Eero </span> </a> <nav class=md-nav aria-label="Stage 1 - Basic Internet Connectivity via C1111 and Eero"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#c1111-configuration-steps class=md-nav__link> <span class=md-ellipsis> C1111 Configuration Steps </span> </a> </li> <li class=md-nav__item> <a href=#eero-configuration-steps class=md-nav__link> <span class=md-ellipsis> Eero Configuration Steps </span> </a> </li> <li class=md-nav__item> <a href=#verification-steps class=md-nav__link> <span class=md-ellipsis> Verification Steps </span> </a> </li> <li class=md-nav__item> <a href=#key-points class=md-nav__link> <span class=md-ellipsis> Key Points </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#stage-2 class=md-nav__link> <span class=md-ellipsis> Stage 2 - Setup Homelab VLAN and Basic Connectivity to C3560 Switch </span> </a> <nav class=md-nav aria-label="Stage 2 - Setup Homelab VLAN and Basic Connectivity to C3560 Switch"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#c1111-configuration-steps_1 class=md-nav__link> <span class=md-ellipsis> C1111 Configuration Steps </span> </a> </li> <li class=md-nav__item> <a href=#c3560-configuration-steps-minimal-initial-setup class=md-nav__link> <span class=md-ellipsis> C3560 Configuration Steps (Minimal Initial Setup) </span> </a> </li> <li class=md-nav__item> <a href=#optional-controller-pc-ssh-configuration class=md-nav__link> <span class=md-ellipsis> (Optional) Controller PC ssh configuration </span> </a> </li> <li class=md-nav__item> <a href=#verification-steps_1 class=md-nav__link> <span class=md-ellipsis> Verification Steps </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#stage-3 class=md-nav__link> <span class=md-ellipsis> Stage 3 - Connect k8s Nodes and NAS to Homelab VLAN &amp; Enable DHCP </span> </a> <nav class=md-nav aria-label="Stage 3 - Connect k8s Nodes and NAS to Homelab VLAN & Enable DHCP"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#c1111-configuration-steps_2 class=md-nav__link> <span class=md-ellipsis> C1111 Configuration Steps </span> </a> </li> <li class=md-nav__item> <a href=#c3560-configuration-steps class=md-nav__link> <span class=md-ellipsis> C3560 Configuration Steps </span> </a> </li> <li class=md-nav__item> <a href=#optional-k8s-nodes-nas-device-network-configuration class=md-nav__link> <span class=md-ellipsis> (Optional) K8s Nodes &amp; NAS Device Network Configuration </span> </a> </li> <li class=md-nav__item> <a href=#verification-steps_2 class=md-nav__link> <span class=md-ellipsis> Verification Steps </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#stage-4 class=md-nav__link> <span class=md-ellipsis> Stage 4 - Implement Basic Firewall Rules (ACLs) on C1111 </span> </a> <nav class=md-nav aria-label="Stage 4 - Implement Basic Firewall Rules (ACLs) on C1111"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#c1111-configuration-steps_3 class=md-nav__link> <span class=md-ellipsis> C1111 Configuration Steps </span> </a> </li> <li class=md-nav__item> <a href=#verification-steps_3 class=md-nav__link> <span class=md-ellipsis> Verification Steps </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting_1 class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class=md-nav aria-label=Troubleshooting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ssh-error-no-matching-key-exchange-method-found class=md-nav__link> <span class=md-ellipsis> SSH error 'no matching key exchange method found' </span> </a> </li> <li class=md-nav__item> <a href=#ssh-error-no-matching-host-key-type-found class=md-nav__link> <span class=md-ellipsis> SSH error 'no matching host key type found' </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing class=md-nav__link> <span class=md-ellipsis> Testing </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../external/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M407.9 319.9 177.1 317c-.7 0-1.4-.2-2-.5s-1.2-.8-1.6-1.4-.7-1.3-.7-2 0-1.4.2-2.1c.4-1.1 1.1-2.1 2.1-2.8s2.1-1.2 3.3-1.2l232.9-2.9c27.6-1.3 57.5-23.6 68-50.8l13.3-34.5c.4-.9.5-1.9.5-2.9 0-.5-.1-1.1-.2-1.6-7.4-32.2-25-61.1-50.3-82.3s-56.7-33.7-89.7-35.5-65.6 7.3-93 25.7-48 45.3-58.8 76.5c-11.3-8.5-24.9-13.3-39-13.7s-28 3.5-39.8 11.4-20.8 19.1-25.9 32.3-5.9 27.6-2.4 41.3C41.7 271.5-.2 314.1-.2 366.5c0 4.7.3 9.3 1 14 .2 1.1.7 2.1 1.5 2.8s1.9 1.1 2.9 1.1l426.1.1h.1c1.2 0 2.3-.4 3.3-1.1s1.6-1.7 2-2.9l3.3-11.3c3.9-13.4 2.4-25.8-4.1-34.9-6-8.4-16.1-13.3-28.2-13.9zm105.9-98.8c-2.1 0-4.3.1-6.4.2-.8.1-1.5.3-2.1.8s-1 1.1-1.3 1.8l-9.1 31.2c-3.9 13.4-2.4 25.8 4.1 34.9 6 8.4 16.1 13.3 28.2 13.9l49.2 2.9c.7 0 1.4.2 2 .5s1.1.8 1.5 1.4.7 1.3.8 2 0 1.5-.2 2.1c-.4 1.1-1.1 2.1-2.1 2.8s-2.1 1.2-3.3 1.2l-51.1 2.9c-27.8 1.3-57.7 23.6-68.1 50.8l-3.7 9.6c-.2.4-.2.8-.2 1.3s.2.8.4 1.2.6.7.9.9.8.3 1.2.3h176c1 0 2-.3 2.8-.9s1.4-1.5 1.7-2.4c3.1-11.1 4.7-22.5 4.7-34 0-69.3-56.5-125.5-126.1-125.5z"/></svg> <span class=md-ellipsis> External Resources </span> </a> </li> <li class=md-nav__item> <a href=../metal/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 1h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1m0 8h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1m0 8h16a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1M9 5h1V3H9zm0 8h1v-2H9zm0 8h1v-2H9zM5 3v2h2V3zm0 8v2h2v-2zm0 8v2h2v-2z"/></svg> <span class=md-ellipsis> Metal Provisioning </span> </a> </li> <li class=md-nav__item> <a href=../../post_install/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 19V7H4v12zm0-16a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2zm-7 14v-2h5v2zm-3.42-4L5.57 9H8.4l3.3 3.3c.39.39.39 1.03 0 1.42L8.42 17H5.59z"/></svg> <span class=md-ellipsis> Post-Install </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../../concepts/ class="md-nav__link "> <span class=md-ellipsis> ☰ Concepts </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> ☰ Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../concepts/certificate_management/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M11.991 0a.883.883 0 0 0-.871.817v3.02a.883.883 0 0 0 .88.884.883.883 0 0 0 .88-.88V.816A.883.883 0 0 0 11.991 0m7.705 3.109a.88.88 0 0 0-.521.174L16.8 5.231a.88.88 0 0 0 .559 1.563.88.88 0 0 0 .56-.2l2.37-1.951a.88.88 0 0 0-.594-1.534M4.32 3.122a.883.883 0 0 0-.611 1.52l2.37 1.951a.88.88 0 0 0 .56.2v-.002a.88.88 0 0 0 .56-1.56L4.828 3.283a.9.9 0 0 0-.508-.16zm7.66 3.228a5.046 5.046 0 0 0-5.026 5.045v1.488H5.787a.967.967 0 0 0-.965.964v9.189a.967.967 0 0 0 .965.964h12.426a.967.967 0 0 0 .964-.964v-9.19a.967.967 0 0 0-.964-.963h-1.168v-1.488A5.046 5.046 0 0 0 11.98 6.35m.012 2.893a2.15 2.15 0 0 1 2.16 2.152v1.488H9.847v-1.488a2.15 2.15 0 0 1 2.145-2.152zm7.382.503a.883.883 0 1 0 .07 1.763h3.027a.883.883 0 0 0 0-1.76h-3.027zM1.529 9.75a.883.883 0 0 0 0 1.76h2.999a.883.883 0 0 0 0-1.76zm10.46 6.774a1.28 1.28 0 0 1 .64 2.393v1.245a.63.63 0 0 1-1.259 0v-1.245a1.28 1.28 0 0 1 .619-2.393"/></svg> <span class=md-ellipsis> Certificate Management </span> </a> </li> <li class=md-nav__item> <a href=../../../concepts/development_shell/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 19V7H4v12zm0-16a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2zm-7 14v-2h5v2zm-3.42-4L5.57 9H8.4l3.3 3.3c.39.39.39 1.03 0 1.42L8.42 17H5.59z"/></svg> <span class=md-ellipsis> Development Shell </span> </a> </li> <li class=md-nav__item> <a href=../../../concepts/pxe_boot/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M15 20a1 1 0 0 0-1-1h-1v-2h4a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h4v2h-1a1 1 0 0 0-1 1H2v2h7a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1h7v-2zm-8-5V5h10v10zm1-8.11 3.56 3.56L8 14h2.53l2.92-2.92c.33-.34.33-.9 0-1.26L10.5 6.89zm8 5.33h-2.67V14H16z"/></svg> <span class=md-ellipsis> PXE Boot </span> </a> </li> <li class=md-nav__item> <a href=../../../concepts/secrets-management/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 12h7c-.53 4.11-3.28 7.78-7 8.92zH5V6.3l7-3.11M12 1 3 5v6c0 5.55 3.84 10.73 9 12 5.16-1.27 9-6.45 9-12V5z"/></svg> <span class=md-ellipsis> Secrets Management </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> ☵ Referece </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> ☵ Referece </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_1> <div class="md-nav__link md-nav__container"> <a href=../../../reference/architecture/ class="md-nav__link "> <span class=md-ellipsis> ☴ Architecture </span> </a> <label class="md-nav__link " for=__nav_4_1 id=__nav_4_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> ☴ Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../reference/architecture/overview/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17.9 17.39c-.26-.8-1.01-1.39-1.9-1.39h-1v-3a1 1 0 0 0-1-1H8v-2h2a1 1 0 0 0 1-1V7h2a2 2 0 0 0 2-2v-.41a7.984 7.984 0 0 1 2.9 12.8M11 19.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.22.21-1.79L9 15v1a2 2 0 0 0 2 2m1-16A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2"/></svg> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/architecture/network/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 2c-1.11 0-2 .89-2 2v3c0 1.11.89 2 2 2h1v2H2v2h4v2H5c-1.11 0-2 .89-2 2v3c0 1.11.89 2 2 2h4c1.11 0 2-.89 2-2v-3c0-1.11-.89-2-2-2H8v-2h8v2h-1c-1.11 0-2 .89-2 2v3c0 1.11.89 2 2 2h4c1.11 0 2-.89 2-2v-3c0-1.11-.89-2-2-2h-1v-2h4v-2h-9V9h1c1.11 0 2-.89 2-2V4c0-1.11-.89-2-2-2zm0 2h4v3h-4zM5 17h4v3H5zm10 0h4v3h-4z"/></svg> <span class=md-ellipsis> Network </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/architecture/decision_records/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 4v18h16v2H4c-1.1 0-2-.9-2-2V4zm11 3h5.5L15 1.5zM8 0h8l6 6v12c0 1.11-.89 2-2 2H8a2 2 0 0 1-2-2V2c0-1.11.89-2 2-2m9 16v-2H8v2zm3-4v-2H8v2z"/></svg> <span class=md-ellipsis> Decision Records </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../../guides/ class="md-nav__link "> <span class=md-ellipsis> ☷ Guides </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> ☷ Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> ☳ HowTo </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> ☳ HowTo </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../guides/how_to_add_dhcp_reservations/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Add DHCP Reservations </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_add_or_remove_nodes/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Add, Move/Rename, Remove Nodes </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_alternate_dns_setup/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Alternate DNS Setup </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_backup_and_restore/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Backup and Restore </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_configure_minicom/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Configure Minicom </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_disable_dhcp_proxy_in_dnsmasq_for_pxe/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Disable DHCP Proxy in dnsmasq for PXE </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_expose_services_to_world/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Expose Services to the World </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_manage_domain_with_cloudflare/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Manage Domain with Cloudflare </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_mount_raid_disk_in_debian/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Mount RAID Disk in Debian </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_onboard_users/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Manage Domain with Cloudflare </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_for_media_management/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Media Management </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_install_debian_on_storage_node/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Install Debian on Storage Node </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_run_cluster_with_a_single_node/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Run the Cluster on a Single Node </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_run_commands_on_multiple_nodes/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Run Commands on Multiple Nodes </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_update_dependencies/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Update Dependencies </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_update_documentation/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Update Documentation </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_update_firmware/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Update Device Firmware </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/how_to_use_both_github_and_gitea/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Use Both GitHub and Gitea </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_3> <label class=md-nav__link for=__nav_5_3 id=__nav_5_3_label tabindex=0> <span class=md-ellipsis> ☶ Troubleshooting </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> ☶ Troubleshooting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../guides/troubleshooting_pxe_boot/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> PXE Boot </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/troubleshooting_renovate/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Renovate </span> </a> </li> <li class=md-nav__item> <a href=../../../guides/troubleshooting_rook_ceph/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.05 13H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5c-3.87 0-7 3.13-7 7s3.13 7 7 7 7-3.13 7-7-3.13-7-7-7m-.87 12.25h1.75V15.5h-1.75zM12 6.75c-1.93 0-3.5 1.57-3.5 3.5h1.75c0-.97.78-1.75 1.75-1.75s1.75.78 1.75 1.75c0 1.75-2.62 1.53-2.62 4.38h1.75c0-1.97 2.62-2.19 2.62-4.38 0-1.93-1.57-3.5-3.5-3.5"/></svg> <span class=md-ellipsis> Rook-Ceph </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <div class="md-nav__link md-nav__container"> <a href=../../../info/ class="md-nav__link "> <span class=md-ellipsis> ⛬ Info </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> ⛬ Info </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../info/roadmap/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m18.25 22-2.75-3 1.16-1.18 1.59 1.59 3.59-3.59L23 17.23zM20.5 3a.5.5 0 0 1 .5.5v9.84c-.63-.22-1.3-.34-2-.34V5.7l-3 1.16v6.94c-.8.47-1.5 1.11-2 1.88V6.87l-4-1.4v11.66l3.05 1.07-.05.8c0 .46.05.92.15 1.35L9 18.9l-5.34 2.07-.16.03a.5.5 0 0 1-.5-.5V5.38c0-.23.15-.41.36-.48L9 3l6 2.1 5.34-2.07zM5 6.46v11.85l3-1.16V5.45z"/></svg> <span class=md-ellipsis> Roadmap </span> </a> </li> <li class=md-nav__item> <a href=../../../info/changelog/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M15 20a1 1 0 0 0 1-1V4H8a1 1 0 0 0-1 1v11H5V5a3 3 0 0 1 3-3h11a3 3 0 0 1 3 3v1h-2V5a1 1 0 0 0-1-1 1 1 0 0 0-1 1v14a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-1h11a2 2 0 0 0 2 2M9 6h5v2H9zm0 4h5v2H9zm0 4h5v2H9z"/></svg> <span class=md-ellipsis> Changelog </span> </a> </li> <li class=md-nav__item> <a href=../../../info/contributing/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M11 6h3l3.29-3.3a1 1 0 0 1 1.42 0l2.58 2.59a1 1 0 0 1 0 1.41L19 9h-8v2a1 1 0 0 1-1 1 1 1 0 0 1-1-1V8a2 2 0 0 1 2-2m-6 5v4l-2.29 2.29a1 1 0 0 0 0 1.41l2.58 2.59a1 1 0 0 0 1.42 0L11 17h4a1 1 0 0 0 1-1v-1h1a1 1 0 0 0 1-1v-1h1a1 1 0 0 0 1-1v-1h-7v1a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V9Z"/></svg> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../../../info/license/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10.08 10.86c.05-.33.16-.62.3-.86.3-.56.81-.85 1.5-.86.45 0 .86.2 1.15.49.28.31.47.74.47 1.17h1.8c-.02-.47-.11-.9-.3-1.3-.15-.38-.38-.72-.68-1-1.45-1.34-4.14-1.15-5.37.37-1.29 1.67-1.32 4.59-.01 6.26 1.21 1.49 3.86 1.7 5.3.37.31-.25.56-.56.76-.92.16-.36.27-.74.28-1.15H13.5c0 .21-.07.4-.16.57-.09.19-.21.34-.34.47-.33.26-.72.4-1.14.4-.36-.01-.66-.08-.89-.23a1.4 1.4 0 0 1-.59-.64c-.5-.9-.42-2.15-.3-3.14M12 2C6.5 2 2 6.5 2 12c.53 13.27 19.5 13.26 20 0 0-5.5-4.5-10-10-10m0 18c-4.41 0-8-3.59-8-8 .44-10.61 15.56-10.61 16 0 0 4.41-3.59 8-8 8"/></svg> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#hardware-requirements class=md-nav__link> <span class=md-ellipsis> Hardware Requirements </span> </a> </li> <li class=md-nav__item> <a href=#serial-console-connection class=md-nav__link> <span class=md-ellipsis> Serial Console Connection </span> </a> <nav class=md-nav aria-label="Serial Console Connection"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#software class=md-nav__link> <span class=md-ellipsis> Software </span> </a> </li> <li class=md-nav__item> <a href=#steps class=md-nav__link> <span class=md-ellipsis> Steps </span> </a> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> <span class=md-ellipsis> References </span> </a> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class=md-nav aria-label=Troubleshooting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#screen-is-terminating-error class=md-nav__link> <span class=md-ellipsis> [screen is terminating] error </span> </a> </li> <li class=md-nav__item> <a href=#no-slow-console-output class=md-nav__link> <span class=md-ellipsis> No (slow) console output </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#configuration-rollout class=md-nav__link> <span class=md-ellipsis> Configuration Rollout </span> </a> <nav class=md-nav aria-label="Configuration Rollout"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#stage-1 class=md-nav__link> <span class=md-ellipsis> Stage 1 - Basic Internet Connectivity via C1111 and Eero </span> </a> <nav class=md-nav aria-label="Stage 1 - Basic Internet Connectivity via C1111 and Eero"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#c1111-configuration-steps class=md-nav__link> <span class=md-ellipsis> C1111 Configuration Steps </span> </a> </li> <li class=md-nav__item> <a href=#eero-configuration-steps class=md-nav__link> <span class=md-ellipsis> Eero Configuration Steps </span> </a> </li> <li class=md-nav__item> <a href=#verification-steps class=md-nav__link> <span class=md-ellipsis> Verification Steps </span> </a> </li> <li class=md-nav__item> <a href=#key-points class=md-nav__link> <span class=md-ellipsis> Key Points </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#stage-2 class=md-nav__link> <span class=md-ellipsis> Stage 2 - Setup Homelab VLAN and Basic Connectivity to C3560 Switch </span> </a> <nav class=md-nav aria-label="Stage 2 - Setup Homelab VLAN and Basic Connectivity to C3560 Switch"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#c1111-configuration-steps_1 class=md-nav__link> <span class=md-ellipsis> C1111 Configuration Steps </span> </a> </li> <li class=md-nav__item> <a href=#c3560-configuration-steps-minimal-initial-setup class=md-nav__link> <span class=md-ellipsis> C3560 Configuration Steps (Minimal Initial Setup) </span> </a> </li> <li class=md-nav__item> <a href=#optional-controller-pc-ssh-configuration class=md-nav__link> <span class=md-ellipsis> (Optional) Controller PC ssh configuration </span> </a> </li> <li class=md-nav__item> <a href=#verification-steps_1 class=md-nav__link> <span class=md-ellipsis> Verification Steps </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#stage-3 class=md-nav__link> <span class=md-ellipsis> Stage 3 - Connect k8s Nodes and NAS to Homelab VLAN &amp; Enable DHCP </span> </a> <nav class=md-nav aria-label="Stage 3 - Connect k8s Nodes and NAS to Homelab VLAN & Enable DHCP"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#c1111-configuration-steps_2 class=md-nav__link> <span class=md-ellipsis> C1111 Configuration Steps </span> </a> </li> <li class=md-nav__item> <a href=#c3560-configuration-steps class=md-nav__link> <span class=md-ellipsis> C3560 Configuration Steps </span> </a> </li> <li class=md-nav__item> <a href=#optional-k8s-nodes-nas-device-network-configuration class=md-nav__link> <span class=md-ellipsis> (Optional) K8s Nodes &amp; NAS Device Network Configuration </span> </a> </li> <li class=md-nav__item> <a href=#verification-steps_2 class=md-nav__link> <span class=md-ellipsis> Verification Steps </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#stage-4 class=md-nav__link> <span class=md-ellipsis> Stage 4 - Implement Basic Firewall Rules (ACLs) on C1111 </span> </a> <nav class=md-nav aria-label="Stage 4 - Implement Basic Firewall Rules (ACLs) on C1111"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#c1111-configuration-steps_3 class=md-nav__link> <span class=md-ellipsis> C1111 Configuration Steps </span> </a> </li> <li class=md-nav__item> <a href=#verification-steps_3 class=md-nav__link> <span class=md-ellipsis> Verification Steps </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting_1 class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class=md-nav aria-label=Troubleshooting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ssh-error-no-matching-key-exchange-method-found class=md-nav__link> <span class=md-ellipsis> SSH error 'no matching key exchange method found' </span> </a> </li> <li class=md-nav__item> <a href=#ssh-error-no-matching-host-key-type-found class=md-nav__link> <span class=md-ellipsis> SSH error 'no matching host key type found' </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing class=md-nav__link> <span class=md-ellipsis> Testing </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/serpro69/ktchn8s/edit/master/docs/installation/production/network.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/serpro69/ktchn8s/raw/master/docs/installation/production/network.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1 id=network-configuration><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 2c-1.11 0-2 .89-2 2v3c0 1.11.89 2 2 2h1v2H2v2h4v2H5c-1.11 0-2 .89-2 2v3c0 1.11.89 2 2 2h4c1.11 0 2-.89 2-2v-3c0-1.11-.89-2-2-2H8v-2h8v2h-1c-1.11 0-2 .89-2 2v3c0 1.11.89 2 2 2h4c1.11 0 2-.89 2-2v-3c0-1.11-.89-2-2-2h-1v-2h4v-2h-9V9h1c1.11 0 2-.89 2-2V4c0-1.11-.89-2-2-2zm0 2h4v3h-4zM5 17h4v3H5zm10 0h4v3h-4z"/></svg></span> Network Configuration<a class=headerlink href=#network-configuration title="Permanent link">&para;</a></h1> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>The following describes my current network components and configurations. Don't blindly copy-paste, but instead use this as a learning point and adjust to your needs, especially if you're using different hardware components.</p> </div> <div class="admonition info"> <p class=admonition-title>Info</p> <p>For an overview of the network setup refer to <a href=../../../reference/architecture/network/ >Network Architecture</a> page.</p> </div> <h2 id=hardware-requirements>Hardware Requirements<a class=headerlink href=#hardware-requirements title="Permanent link">&para;</a></h2> <ul> <li>Cisco C1111-8P Router</li> <li>Cisco C3560-GS-8P Switch</li> <li>Eero 6 Router</li> <li>Serial Console Cable</li> <li>"Controller" PC<ul> <li>Any OS can be used, but since I work on Linux I won't provide serial console connectivity specifics for other OSes (which can also easily be found online). PRs with docs improvements are always welcome!</li> </ul> </li> </ul> <h2 id=serial-console-connection>Serial Console Connection<a class=headerlink href=#serial-console-connection title="Permanent link">&para;</a></h2> <h3 id=software>Software<a class=headerlink href=#software title="Permanent link">&para;</a></h3> <p>(In order of preference based on own brief experience)</p> <ul> <li><a href=https://help.ubuntu.com/community/Minicom>minicom</a><ul> <li>easy to get started/configure with self-explanatory built-in help menu</li> <li>seems to have some extra useful functionality</li> <li><em>NB! default <code>Ctrl-A</code> shortcut conflicts with my current <code>tmux</code> modifier key, hence I usually use <code>minicom</code> outside of <code>tmux</code></em></li> </ul> </li> <li><a href=https://www.gnu.org/software/screen/manual/screen.html>screen</a></li> <li><a href=https://github.com/wvdakker/gtkterm>gtkterm</a><ul> <li>standalone terminal with easy UI/configurations, but doesn't seem to bring much more value compared to <code>minicom</code></li> <li>only tried it briefly</li> </ul> </li> </ul> <h3 id=steps>Steps<a class=headerlink href=#steps title="Permanent link">&para;</a></h3> <ul> <li>Install <code>minicom</code> (alternatively install <code>screen</code> or <code>gtkterm</code>, whichever you like best)<ul> <li>On ubuntu: <code>sudo apt install minicom</code></li> </ul> </li> <li>Connect the serial cable to the switch/router and PC</li> <li>Determine the port of the serial cable: <code>sudo dmesg | grep -i tty</code><ul> <li>Let's assume the device port was <code>ttyUSB0</code></li> </ul> </li> <li>Follow the <a href=../../../guides/how_to_configure_minicom/ >minicom configuration guide</a> to configure it</li> <li>Start minicom: <code>sudo minicom</code><ul> <li>Alternatively, using screen: <code>sudo screen /dev/ttyUSB0 9600</code></li> </ul> </li> </ul> <h3 id=references>References<a class=headerlink href=#references title="Permanent link">&para;</a></h3> <ul> <li><a href=https://www.cisco.com/c/en/us/support/docs/storage-networking/management/217970-troubleshoot-and-apply-correct-terminal.html>Troubleshoot and Apply Correct Terminal Emulator Settings for Console Connections</a></li> <li>C1111 startup-config files<ul> <li><a href=https://github.com/serpro69/ktchn8s/blob/master/docs/installation/.files/muspell_startup-config_stage3.txt>stage 3</a></li> <li><a href=https://github.com/serpro69/ktchn8s/blob/master/docs/installation/.files/muspell_startup-config_stage4.txt>stage 4</a></li> </ul> </li> <li>C3560 startup-config files<ul> <li><a href=https://github.com/serpro69/ktchn8s/blob/master/docs/installation/.files/bifrost_startup-config_stage3.txt>stage 3</a></li> </ul> </li> </ul> <h3 id=troubleshooting>Troubleshooting<a class=headerlink href=#troubleshooting title="Permanent link">&para;</a></h3> <h4 id=screen-is-terminating-error><code>[screen is terminating]</code> error<a class=headerlink href=#screen-is-terminating-error title="Permanent link">&para;</a></h4> <p><strong>tldr;</strong> either add your user to <code>dialout</code> group, or run <code>screen</code> with <code>sudo</code></p> <p>Long version based on this <a href=https://unix.stackexchange.com/a/529120>unix.stackexchange answer</a>:</p> <p>Does the user account have the permission to use <code>/dev/ttyUSB0</code>? To find out, please run <code>ls -l /dev/ttyUSB0</code>. The output might look like this:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>$ ls -l /dev/ttyUSB0
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>crw-rw----+ 1 root dialout 166, 0 Jul  9 08:55 /dev/ttyUSB0
</span></code></pre></div> <p>The characters at the left-most column are the file type and permissions information:</p> <ul> <li>The first character is <code>c</code>, indicating a character-based device.</li> <li>The last character is <code>+</code>, indicating that there is an Access Control List (ACL for short) on this device node, specifying further access rules. This is important, because it changes how the other permissions are interpreted.</li> <li>The characters 2-4 are a three-letter group <code>rw-</code> indicating permissions for the file owner, which is <code>root</code> as indicated in the third column.</li> <li>The second group of three letters (<code>rw-</code> again) would classically indicate permissions applicable to the <em>group</em> of users the file is assigned to. In this case, the group is <code>dialout</code> as indicated in the fourth column. <strong>But because this file has an ACL, the meaning is different:</strong> with an ACL in effect, it just indicates the highest permissions granted to a specific user or group that is not the file owner - but you cannot know which user or group it is.</li> <li>The third group of three letters (<code>---</code>) indicate access permissions for everyone else - if it's all dashes, it means no access is allowed.</li> <li>The last character is <code>+</code>, indicating that there is an Access Control List (ACL for short) on this device node, specifying further access rules.</li> </ul> <p>Lastly, the ACL can be viewed with <code>getfacl /dev/ttyUSB0</code>. The output might look something like this:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>getfacl<span class=w> </span>/dev/ttyUSB0
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>getfacl: Removing leading &#39;/&#39; from absolute path names
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a># file: dev/ttyUSB0
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a># owner: root
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a># group: dialout
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>user::rw-
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>user:sddm:rw-
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>group::rw-
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>mask::rw-
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>other::---
</span></code></pre></div> <p>Basically, it repeats the traditional non-ACL file permissions and allows specifying extra permissions for any number of users and groups. In this case, there is an extra line <code>user:sddm:rw-</code> indicating both read and write access to user <code>sddm</code>, which is the user account the GUI login manager process <code>sddm</code> is currently running as. And there's also the <code>group::rw-</code> line that confirms that the classic <code>dialout</code> group has full read/write access to this file - this information was hidden from the classic <code>ls -l</code> output when an ACL was applied to this device node.</p> <p>The fact that an ACL grants permissions to <code>sddm</code> indicates that this OS is probably configured to automatically grant access to local serial ports if you log in locally using the GUI login dialog. The ACL would be automatically changed to match the logged-in user, and back to <code>sddm</code> when the user logs out. If such an ACL is not present, then your distribution might not use such an automatic permissions mechanism.</p> <p>The group name <code>dialout</code> is historical, because serial ports used to be used with modems. But if a device is assigned to a special group like this, it indicates the distribution is probably configured to manage access to serial ports using the <code>dialout</code> group. So in this example, you might want to add your user account to the <code>dialout</code> group. You'll need root/superuser access to do that:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>sudo<span class=w> </span>usermod<span class=w> </span>-a<span class=w> </span>-G<span class=w> </span>dialout<span class=w> </span>eric
</span></code></pre></div> <p>New group memberships take effect at next login, so you'll need to log out and back again. Alternatively run:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>newgrp<span class=w> </span>dialout
</span></code></pre></div> <p>Because the <code>/dev</code> filesystem is a virtual, RAM-based filesystem, all the device nodes are created from scratch every time the system boots. Because of this, trying to change the permissions of the actual device nodes would be futile; your changes would be forgotten when you shut down the system. Instead, the default permissions for the devices use specific groups, for the express purpose of allowing the administrators to use group memberships to grant specific users access to specific types of devices: using those groups as intended is probably the easiest way to solve your problem.</p> <h4 id=no-slow-console-output>No (slow) console output<a class=headerlink href=#no-slow-console-output title="Permanent link">&para;</a></h4> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>Usually console output problems are related to faulty or poor-quality cables.</p> </div> <ul> <li>Check the cable connection and ensure that the serial console cable is properly connected to both the switch/router and the PC.</li> <li>Try to reset the cable.</li> </ul> <p>References:</p> <ul> <li><a href=https://www.reddit.com/r/homelab/comments/nyacjw/no_console_output_on_cisco_switch/ >https://www.reddit.com/r/homelab/comments/nyacjw/no_console_output_on_cisco_switch/</a></li> <li><a href=https://community.cisco.com/t5/switching/blank-screen-and-no-console-access-on-cisco-switch/td-p/2964716>https://community.cisco.com/t5/switching/blank-screen-and-no-console-access-on-cisco-switch/td-p/2964716</a></li> </ul> <h2 id=configuration-rollout>Configuration Rollout<a class=headerlink href=#configuration-rollout title="Permanent link">&para;</a></h2> <div class="admonition info"> <p class=admonition-title>Info</p> <p>I've broken down the network configuration rollout into several stages which allowed me to work in small, incremental iterations and test/rollback things easier w/o introducing big updates.</p> </div> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>Before saving the <code>running-config</code>, run <code>show running-config</code> to verify the current running configuration matches your expectations. You can, and should, also test things before saving the running configuration to avoid issues and unnecessary roll-backs. After verifying that everything works as expected and saving the running configuration, I also back up the updated <code>startup-config</code> (e.g. <code>copy startup-config bootflash:/startup-config_stage3.bak</code>) for any future reference and to be able to easily revert to a particular roll-out stage in case of issues.</p> </div> <h3 id=stage-1>Stage 1 - Basic Internet Connectivity via C1111 and Eero<a class=headerlink href=#stage-1 title="Permanent link">&para;</a></h3> <ul> <li><strong>Goal:</strong> Home devices (laptop, phone) can connect to the Eero (in bridge mode) and access the internet. The C1111 handles routing, NAT, and DHCP for the home network.</li> </ul> <h4 id=c1111-configuration-steps>C1111 Configuration Steps<a class=headerlink href=#c1111-configuration-steps title="Permanent link">&para;</a></h4> <ul> <li> <p><strong>Initial Access &amp; Factory Reset (Optional but Recommended):</strong></p> <ul> <li>Connect via console cable.</li> <li> <p>If starting fresh:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>enable
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>write erase
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>reload
</span></code></pre></div> <p>(After reload, when prompted <code>Would you like to enter the initial configuration dialog? [yes/no]:</code>, enter <code>no</code>.)</p> </li> <li> <p><strong>(Optional) Verify/cleanup VTP and Vlan configuration leftovers:</strong></p> <ul> <li>If you've bought a used device, then <code>write erase</code> might not remove old VLANs.</li> <li><strong>Persistence of VLAN/VTP:</strong> On devices with integrated switching capabilities (like your C1111-8P) or dedicated switches, VLAN and VTP information can sometimes be more persistent than the rest of the startup configuration. For dedicated Catalyst switches, the <code>vlan.dat</code> file in flash memory is the prime example. For example, my C1111's switch module seems to have a similar mechanism or <code>write erase</code> doesn't touch that specific part of NVRAM as thoroughly as one might expect for these settings.</li> <li><strong>Importance of <code>vtp mode transparent</code> or <code>off</code>:</strong> If you inherit a device or aren't sure of its VTP state, setting it to <code>transparent</code> (and ensuring no unwanted domain name) is a crucial first step to prevent it from being adversely affected by or adversely affecting other switches if you were to connect it to a network already using VTP.<ul> <li><strong>To clean up the VTP domain name specifically:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>configure terminal
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>! Ensure mode is transparent
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>vtp mode transparent
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>! Try to remove the domain name
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>no vtp domain &lt;current_vtp_domain_name&gt;
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>! If &quot;no vtp domain&quot; doesn&#39;t work or if you want to explicitly set it to null:
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>! vtp domain &quot;&quot;
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>! (Some IOS versions accept a null string. Test this. If it errors, use a custom name.)
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a>! Or set it to a custom, non-conflicting name:
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a>! vtp domain MYVTPDOMAIN_UNUSED
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a>exit
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a>write memory
</span></code></pre></div></li> </ul> </li> <li><strong>Thorough Reset Procedure:</strong> For a truly "factory fresh" state on a switch or device with switching capabilities, beyond <code>write erase</code>, one might also need to:<ul> <li>Delete the <code>vlan.dat</code> file from flash (e.g., <code>delete flash:vlan.dat</code> on Catalyst switches, then reload). The exact procedure or file name might vary for integrated switch modules on routers.</li> <li>Ensure the VTP domain is nullified or set to default, and the mode is transparent or off.</li> </ul> </li> </ul> </li> </ul> </li> <li> <p><strong>Basic Device Setup:</strong></p> <div class="language-text highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>enable
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>configure terminal
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>hostname muspell                        ! Muspelheim in Norse mythology is the primordial realm of fire, according to Snorri,
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>                                        ! which was instrumental in the creation of the world
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>enable secret &lt;your_strong_password&gt;
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>username &lt;your_admin_user&gt; privilege 15 secret &lt;your_admin_password&gt;
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>line con 0
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a> login local
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a> logging synchronous                    ! Prevents console messages from interrupting typing
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>exit
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>line vty 0 4
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a> login local
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a> transport input ssh
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a>exit
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a>ip domain name midgard.local            ! Or your preferred local domain
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a>crypto key generate rsa modulus 2048    ! For SSH
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a>service password-encryption             ! Encrypts plaintext passwords in the config
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a>
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a>no ip http server                       ! Disable HTTP management interface
</span><span id=__span-7-28><a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a>no ip http secure-server                ! Disable HTTPS management interface
</span><span id=__span-7-29><a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a>
</span><span id=__span-7-30><a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a>clock timezone UTC 0 0                  ! Or your local timezone
</span><span id=__span-7-31><a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a>ntp server 0.pool.ntp.org prefer
</span><span id=__span-7-32><a id=__codelineno-7-32 name=__codelineno-7-32 href=#__codelineno-7-32></a>ntp server 1.pool.ntp.org
</span><span id=__span-7-33><a id=__codelineno-7-33 name=__codelineno-7-33 href=#__codelineno-7-33></a>ntp server 2.pool.ntp.org
</span></code></pre></div> </li> <li> <p><strong>WAN Interface Configuration (Assuming <code>GigabitEthernet0/0/0</code> is a dedicated routed WAN port):</strong></p> <div class="language-text highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>interface GigabitEthernet0/0/0
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a> description WAN_to_ISP_Modem
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a> ip address dhcp                ! Assuming the ISP modem provides an IP via DHCP
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a> ip nat outside
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a> negotiation auto               ! Usually default, but good to ensure
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a> no shutdown
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>exit
</span></code></pre></div> <ul> <li> <p><strong>Note:</strong> The command <code>ip address dhcp</code> should work if your ISP modem is providing DHCP. If your ISP requires PPPoE, the configuration here would be very different (involving a Dialer interface).</p> </li> <li> <p><strong>If <code>GigabitEthernet0/0/0</code> is <em>not</em> a dedicated WAN port and is actually part of the switch block (unlikely for <code>0/0/x</code> naming but possible on some variants):</strong></p> <ul> <li>You would <em>not</em> configure <code>ip address dhcp</code> directly. Instead, you'd create a "WAN VLAN" (e.g., VLAN 99), assign this physical port to VLAN 99, create <code>interface Vlan99</code>, and put <code>ip address dhcp</code> and <code>ip nat outside</code> on <code>interface Vlan99</code>.</li> <li><em>This is a crucial distinction based on your router's specific hardware port types.</em></li> </ul> </li> </ul> </li> <li> <p><strong>Home Network LAN Configuration (<em>using integrated switchports</em>):</strong></p> <ul> <li> <p>First, create the VLAN globally:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>vlan 2
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a> name HOME_NETWORK
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>exit
</span></code></pre></div> </li> <li> <p>Next, create the Switched Virtual Interface (SVI) for Layer 3 routing for this VLAN:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>interface Vlan2
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a> description Gateway_for_Home_Network_192.168.1.0
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a> ip address 192.168.1.1 255.255.255.0
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a> ip nat inside
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a> no shutdown
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>exit
</span></code></pre></div> </li> <li> <p>Then, assign a physical switchport to this VLAN (e.g., <code>GigabitEthernet0/1/0</code> for the Eero):</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>interface GigabitEthernet0/1/0
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a> description LAN_to_Eero_AP_VLAN2
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a> switchport mode access      ! This port will only carry traffic for one VLAN
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a> switchport access vlan 2  ! Assigns this port to VLAN 2
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a> spanning-tree portfast    ! Recommended for edge ports connected to end devices/APs
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a> no shutdown
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>exit
</span></code></pre></div> </li> </ul> </li> <li> <p><strong>DHCP Server Configuration for Home Network (VLAN 2):</strong></p> <div class="language-text highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>ip dhcp excluded-address 192.168.1.1 192.168.1.9  ! Reserve IPs for router, Eero mgmt, etc.
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>!
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>ip dhcp pool HOME_POOL_VLAN2
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a> network 192.168.1.0 255.255.255.0
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a> default-router 192.168.1.1         ! Gateway for clients in this pool
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a> dns-server 1.1.1.1 8.8.8.8         ! Start with public DNS servers
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a> lease 1                            ! Lease time in days (e.g., 1 day)
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a> domain-name midgard.local          ! (Optional: provides domain suffix to clients.) Midgard is the realm of humans in Norse mythology
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a>exit
</span></code></pre></div> </li> <li> <p><strong>Network Address Translation (NAT) Configuration:</strong></p> <ul> <li> <p>Define an access list to identify traffic from your Home Network that needs to be NATted:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>ip access-list standard ACL_NAT_HOME_NETWORK
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a> permit 192.168.1.0 0.0.0.255
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>exit
</span></code></pre></div> </li> <li> <p>Apply NAT, translating addresses from <code>ACL_NAT_HOME_NETWORK</code> to the IP address of the <code>GigabitEthernet0/0/0</code> (WAN) interface:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>ip nat inside source list ACL_NAT_HOME_NETWORK interface GigabitEthernet0/0/0 overload
</span></code></pre></div> <ul> <li><strong>Note:</strong> This assumes <code>GigabitEthernet0/0/0</code> is the correct NAT outside interface. If your WAN setup uses an SVI (e.g., <code>interface Vlan99</code> because you're using a switchport for WAN), then that SVI would be specified here instead of the physical interface.</li> </ul> </li> </ul> </li> <li> <p><strong>Default Route to the Internet:</strong></p> <ul> <li> <p>If <code>ip address dhcp</code> on the WAN interface (<code>GigabitEthernet0/0/0</code>) successfully obtains an IP and a default gateway from your ISP modem, a default route should be automatically installed. You can verify with <code>show ip route</code>.</p> </li> <li> <p>If a default route is not automatically installed, or if you had a static public IP, you'd add it manually (this is less common for typical home ISP DHCP setups):</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>! ip route 0.0.0.0 0.0.0.0 &lt;IP_of_ISP_Modem_Gateway_on_WAN_subnet&gt;
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>! or potentially just:
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>! ip route 0.0.0.0 0.0.0.0 GigabitEthernet0/0/0
</span></code></pre></div> <p>For now, we rely on DHCP to provide the route.</p> </li> </ul> </li> <li> <p><strong>Save Configuration:</strong></p> <div class="language-text highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a>end
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>write memory
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>! or
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>! copy running-config startup-config
</span></code></pre></div> </li> <li> <p><strong>(Optional) Disable call-home</strong></p> <div class="language-text highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a>no service call-home
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>! Potentially also remove the call-home profile if you&#39;re not using it
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>no call-home
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>no profile &quot;CiscoTAC-1&quot;
</span></code></pre></div> </li> </ul> <h4 id=eero-configuration-steps>Eero Configuration Steps<a class=headerlink href=#eero-configuration-steps title="Permanent link">&para;</a></h4> <ul> <li>Physically connect Eero WAN port to <code>GigabitEthernet0/1/0</code> on C1111.</li> <li>Factory reset Eero if needed.<ul> <li>Note: I didn't perform a reset or anything, keept using existing configuration and mobile eero app as it was</li> <li>Follow Eero app setup instructions.</li> </ul> </li> <li>Configure Eero in Access Point mode:<ul> <li>In order for eeros to be used as Access Points, you will need to wire one eero to your existing router and set it up in Double NAT. Once the setup is complete, you can go to the Settings--Network Settings--DHCP &amp; NAT and select Bridge. Let the system reboot and the eeros will no longer perform DHCP.</li> <li>tldr: connect the Eero to C1111 g0/1/0 port, open eero app and wait for it to show that it has internet connection, then change it to bridge mode, wait for it to restart and show as online again in the app, profit</li> <li>ref: <a href="https://www.reddit.com/r/eero/comments/uuuvdc/comment/i9hkazz/?utm_source=share&utm_medium=web3x&utm_name=web3xcss&utm_term=1&utm_content=share_button">https://www.reddit.com/r/eero/comments/uuuvdc/comment/i9hkazz/?utm_source=share&amp;utm_medium=web3x&amp;utm_name=web3xcss&amp;utm_term=1&amp;utm_content=share_button</a></li> </ul> </li> <li>Configure WiFi SSID and password (if wasn't configured previously)<ul> <li>Since I didn't reset the Eero router, I could just keep using the existing SSID w/o any modifications needed</li> </ul> </li> </ul> <h4 id=verification-steps>Verification Steps<a class=headerlink href=#verification-steps title="Permanent link">&para;</a></h4> <ul> <li>On C1111:<ul> <li><code>show ip interface brief</code>:<ul> <li><code>GigabitEthernet0/0/0</code> should be <code>up</code>, <code>up</code>, method <code>DHCP</code>, status <code>administratively down</code> if <code>no shutdown</code> was missed. IP should be public.</li> <li><code>Vlan2</code> should be <code>up</code>, <code>up</code>, with IP <code>192.168.1.1</code>.</li> <li><code>GigabitEthernet0/1/0</code> should be <code>up</code>, <code>up</code>.</li> </ul> </li> <li><code>show vlan brief</code>: Should show VLAN 2 "HOME_NETWORK" active with port <code>Gi0/1/0</code> assigned.</li> <li><code>show ip route</code>: Crucially, look for a default route (e.g., <code>S* 0.0.0.0/0 [1/0] via &lt;ISP_GATEWAY_IP&gt;</code> or <code>S* 0.0.0.0/0 is directly connected, GigabitEthernet0/0/0</code> if DHCP sets it that way).</li> <li><code>show ip nat translations</code>: Will be empty initially, but will populate as devices NAT out.</li> <li><code>ping 1.1.1.1 source Vlan2</code> (or <code>ping 1.1.1.1</code> if that doesn't work, try pinging from global exec mode).</li> <li>Verify ntp status on C1111 is synchronized, check ntp associations <div class="language-text highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a>sh clock
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>14:31:38.416 UTC Wed Jun 11 2025
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a>sh ntp status
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>Clock is synchronized, stratum 3, reference is 82.148.168.42
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>nominal freq is 250.0000 Hz, actual freq is 249.9955 Hz, precision is 2**10
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>ntp uptime is 132400 (1/100 of seconds), resolution is 4016
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>reference time is EBF411C2.FB22D398 (14:31:30.981 UTC Wed Jun 11 2025)
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>clock offset is 0.6257 msec, root delay is 10.39 msec
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a>root dispersion is 7941.97 msec, peer dispersion is 188.53 msec
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a>loopfilter state is &#39;CTRL&#39; (Normal Controlled Loop), drift is 0.000018037 s/s
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a>system poll interval is 64, last update was 13 sec ago.
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>sh ntp associations
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>  address         ref clock       st   when   poll reach  delay  offset   disp
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>*~82.148.168.42   62.92.229.27     2     48     64     1  1.913   0.625 188.53
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>+~192.36.143.130  .PPS.            1     59     64     1 13.999  -1.548 7937.9
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a>+~77.104.162.218  .PPS.            1     58     64     1 47.970  -3.393 7937.9
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a> * sys.peer, # selected, + candidate, - outlyer, x falseticker, ~ configured
</span></code></pre></div></li> </ul> </li> <li>Connect a laptop/phone to the Eero's WiFi.</li> <li>Verify laptop/phone gets an IP from <code>192.168.1.x</code> range, gateway <code>192.168.1.1</code>, DNS <code>1.1.1.1</code>/<code>8.8.8.8</code>.</li> <li>Verify laptop/phone can browse the internet.</li> <li>On C1111, <code>show ip nat translations</code> should now show entries.</li> </ul> <h4 id=key-points>Key Points<a class=headerlink href=#key-points title="Permanent link">&para;</a></h4> <ul> <li>The C1111-8P acts like a router with an integrated switch.</li> <li>You define VLANs globally (<code>vlan &lt;id&gt;</code>).</li> <li>You create SVIs (<code>interface Vlan&lt;id&gt;</code>) to give those VLANs Layer 3 gateway IPs.</li> <li>You assign the integrated physical switchports (<code>GigabitEthernet0/1/x</code>) to these VLANs in access mode.</li> <li>The dedicated WAN port (<code>GigabitEthernet0/0/0</code>) is typically a routed port, not a switchport.</li> </ul> <h3 id=stage-2>Stage 2 - Setup Homelab VLAN and Basic Connectivity to C3560 Switch<a class=headerlink href=#stage-2 title="Permanent link">&para;</a></h3> <ul> <li> <p><strong>Goal:</strong> The C3560 switch is connected to the C1111, and the Homelab VLAN (<code>VLAN 10</code>) is active on the C1111. The C3560 can be managed via its IP on VLAN 10, and devices in VLAN 10 (including the switch itself) can potentially reach the internet if NAT is updated.</p> </li> <li> <p><strong>Physical Connection:</strong> Connect a network cable from C1111's <code>GigabitEthernet0/1/1</code> port to C3560's <code>GigabitEthernet0/9</code> port (or your chosen uplink port on the C3560).</p> </li> </ul> <h4 id=c1111-configuration-steps_1>C1111 Configuration Steps<a class=headerlink href=#c1111-configuration-steps_1 title="Permanent link">&para;</a></h4> <div class="language-text highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a>! Enter global configuration mode
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>configure terminal
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a>! --- Homelab VLAN Definition ---
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>! Create VLAN 10 globally on the router
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>vlan 10
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a> ! Assign a descriptive name to VLAN 10
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a> name HOMELAB_SERVERS
</span><span id=__span-21-9><a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a>exit
</span><span id=__span-21-10><a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a>
</span><span id=__span-21-11><a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a>! --- Homelab Switched Virtual Interface (SVI) for Layer 3 ---
</span><span id=__span-21-12><a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a>! Create a virtual interface representing VLAN 10 for routing
</span><span id=__span-21-13><a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a>interface Vlan10
</span><span id=__span-21-14><a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a> ! Add a description for this interface
</span><span id=__span-21-15><a id=__codelineno-21-15 name=__codelineno-21-15 href=#__codelineno-21-15></a> description Gateway_for_Homelab_Network_10.10.10.0
</span><span id=__span-21-16><a id=__codelineno-21-16 name=__codelineno-21-16 href=#__codelineno-21-16></a> ! Assign an IP address and subnet mask to this SVI. This will be the gateway for devices in VLAN 10.
</span><span id=__span-21-17><a id=__codelineno-21-17 name=__codelineno-21-17 href=#__codelineno-21-17></a> ip address 10.10.10.1 255.255.255.0
</span><span id=__span-21-18><a id=__codelineno-21-18 name=__codelineno-21-18 href=#__codelineno-21-18></a> ! Include traffic from this interface in NAT (Network Address Translation)
</span><span id=__span-21-19><a id=__codelineno-21-19 name=__codelineno-21-19 href=#__codelineno-21-19></a> ! so devices in VLAN 10 can access the internet via the router&#39;s WAN IP.
</span><span id=__span-21-20><a id=__codelineno-21-20 name=__codelineno-21-20 href=#__codelineno-21-20></a> ip nat inside
</span><span id=__span-21-21><a id=__codelineno-21-21 name=__codelineno-21-21 href=#__codelineno-21-21></a> ! Ensure the interface is administratively up
</span><span id=__span-21-22><a id=__codelineno-21-22 name=__codelineno-21-22 href=#__codelineno-21-22></a> no shutdown
</span><span id=__span-21-23><a id=__codelineno-21-23 name=__codelineno-21-23 href=#__codelineno-21-23></a>exit
</span><span id=__span-21-24><a id=__codelineno-21-24 name=__codelineno-21-24 href=#__codelineno-21-24></a>
</span><span id=__span-21-25><a id=__codelineno-21-25 name=__codelineno-21-25 href=#__codelineno-21-25></a>! --- LAN Port Configuration for Connection to C3560 Switch ---
</span><span id=__span-21-26><a id=__codelineno-21-26 name=__codelineno-21-26 href=#__codelineno-21-26></a>! Select the physical switchport on the C1111 that connects to the C3560
</span><span id=__span-21-27><a id=__codelineno-21-27 name=__codelineno-21-27 href=#__codelineno-21-27></a>interface GigabitEthernet0/1/1
</span><span id=__span-21-28><a id=__codelineno-21-28 name=__codelineno-21-28 href=#__codelineno-21-28></a> ! Add a description for this port
</span><span id=__span-21-29><a id=__codelineno-21-29 name=__codelineno-21-29 href=#__codelineno-21-29></a> description Link_To_C3560_Homelab_Switch
</span><span id=__span-21-30><a id=__codelineno-21-30 name=__codelineno-21-30 href=#__codelineno-21-30></a> ! Set the port to access mode, meaning it will carry traffic for a single VLAN
</span><span id=__span-21-31><a id=__codelineno-21-31 name=__codelineno-21-31 href=#__codelineno-21-31></a> switchport mode access
</span><span id=__span-21-32><a id=__codelineno-21-32 name=__codelineno-21-32 href=#__codelineno-21-32></a> ! Assign this access port to VLAN 10
</span><span id=__span-21-33><a id=__codelineno-21-33 name=__codelineno-21-33 href=#__codelineno-21-33></a> switchport access vlan 10
</span><span id=__span-21-34><a id=__codelineno-21-34 name=__codelineno-21-34 href=#__codelineno-21-34></a> ! Enable PortFast: causes a Layer 2 access port to enter the forwarding state immediately,
</span><span id=__span-21-35><a id=__codelineno-21-35 name=__codelineno-21-35 href=#__codelineno-21-35></a> ! bypassing the listening and learning states. Use only on ports connected to end devices or
</span><span id=__span-21-36><a id=__codelineno-21-36 name=__codelineno-21-36 href=#__codelineno-21-36></a> ! to another switch where no loops are expected through this port.
</span><span id=__span-21-37><a id=__codelineno-21-37 name=__codelineno-21-37 href=#__codelineno-21-37></a> spanning-tree portfast
</span><span id=__span-21-38><a id=__codelineno-21-38 name=__codelineno-21-38 href=#__codelineno-21-38></a> ! Ensure the physical port is administratively up
</span><span id=__span-21-39><a id=__codelineno-21-39 name=__codelineno-21-39 href=#__codelineno-21-39></a> no shutdown
</span><span id=__span-21-40><a id=__codelineno-21-40 name=__codelineno-21-40 href=#__codelineno-21-40></a>exit
</span><span id=__span-21-41><a id=__codelineno-21-41 name=__codelineno-21-41 href=#__codelineno-21-41></a>
</span><span id=__span-21-42><a id=__codelineno-21-42 name=__codelineno-21-42 href=#__codelineno-21-42></a>! --- Update NAT Access Control List (ACL) ---
</span><span id=__span-21-43><a id=__codelineno-21-43 name=__codelineno-21-43 href=#__codelineno-21-43></a>! If you want Homelab devices to have internet access immediately.
</span><span id=__span-21-44><a id=__codelineno-21-44 name=__codelineno-21-44 href=#__codelineno-21-44></a>! First, remove the old NAT ACL if it was specific to only the Home Network.
</span><span id=__span-21-45><a id=__codelineno-21-45 name=__codelineno-21-45 href=#__codelineno-21-45></a>! (Check your running config for the exact name you used in Stage 1, e.g., ACL_NAT_HOME_NETWORK)
</span><span id=__span-21-46><a id=__codelineno-21-46 name=__codelineno-21-46 href=#__codelineno-21-46></a>no ip access-list standard ACL_NAT_HOME_NETWORK
</span><span id=__span-21-47><a id=__codelineno-21-47 name=__codelineno-21-47 href=#__codelineno-21-47></a>
</span><span id=__span-21-48><a id=__codelineno-21-48 name=__codelineno-21-48 href=#__codelineno-21-48></a>! Create a new (or modify existing) standard ACL to permit traffic from BOTH Home and Homelab networks for NAT.
</span><span id=__span-21-49><a id=__codelineno-21-49 name=__codelineno-21-49 href=#__codelineno-21-49></a>ip access-list standard ACL_NAT_TRAFFIC_ALL_LANS
</span><span id=__span-21-50><a id=__codelineno-21-50 name=__codelineno-21-50 href=#__codelineno-21-50></a> ! Permit traffic from the Home Network (192.168.1.0/24)
</span><span id=__span-21-51><a id=__codelineno-21-51 name=__codelineno-21-51 href=#__codelineno-21-51></a> permit 192.168.1.0 0.0.0.255
</span><span id=__span-21-52><a id=__codelineno-21-52 name=__codelineno-21-52 href=#__codelineno-21-52></a> ! Permit traffic from the Homelab Network (10.10.10.0/24)
</span><span id=__span-21-53><a id=__codelineno-21-53 name=__codelineno-21-53 href=#__codelineno-21-53></a> permit 10.10.10.0 0.0.0.255
</span><span id=__span-21-54><a id=__codelineno-21-54 name=__codelineno-21-54 href=#__codelineno-21-54></a>exit
</span><span id=__span-21-55><a id=__codelineno-21-55 name=__codelineno-21-55 href=#__codelineno-21-55></a>
</span><span id=__span-21-56><a id=__codelineno-21-56 name=__codelineno-21-56 href=#__codelineno-21-56></a>end
</span><span id=__span-21-57><a id=__codelineno-21-57 name=__codelineno-21-57 href=#__codelineno-21-57></a>
</span><span id=__span-21-58><a id=__codelineno-21-58 name=__codelineno-21-58 href=#__codelineno-21-58></a>! Clear active NAT translations using older NAT acl rule.
</span><span id=__span-21-59><a id=__codelineno-21-59 name=__codelineno-21-59 href=#__codelineno-21-59></a>! You need to clear these active translations before you can remove or modify the NAT rule.
</span><span id=__span-21-60><a id=__codelineno-21-60 name=__codelineno-21-60 href=#__codelineno-21-60></a>! `*`: This clears all dynamic NAT translations. You can be more specific if needed, but for a homelab environment during setup, clearing all is usually fine and quickest.
</span><span id=__span-21-61><a id=__codelineno-21-61 name=__codelineno-21-61 href=#__codelineno-21-61></a>! NB! This will temporarily drop any active internet sessions for devices being NATted by this rule.
</span><span id=__span-21-62><a id=__codelineno-21-62 name=__codelineno-21-62 href=#__codelineno-21-62></a>clear ip nat translation *
</span><span id=__span-21-63><a id=__codelineno-21-63 name=__codelineno-21-63 href=#__codelineno-21-63></a>
</span><span id=__span-21-64><a id=__codelineno-21-64 name=__codelineno-21-64 href=#__codelineno-21-64></a>configure terminal
</span><span id=__span-21-65><a id=__codelineno-21-65 name=__codelineno-21-65 href=#__codelineno-21-65></a>
</span><span id=__span-21-66><a id=__codelineno-21-66 name=__codelineno-21-66 href=#__codelineno-21-66></a>! --- Update NAT Rule to use the new/updated ACL ---
</span><span id=__span-21-67><a id=__codelineno-21-67 name=__codelineno-21-67 href=#__codelineno-21-67></a>! First, remove the old NAT rule that used the old ACL.
</span><span id=__span-21-68><a id=__codelineno-21-68 name=__codelineno-21-68 href=#__codelineno-21-68></a>! (The interface GigabitEthernet0/0/0 is assumed to be your WAN interface)
</span><span id=__span-21-69><a id=__codelineno-21-69 name=__codelineno-21-69 href=#__codelineno-21-69></a>no ip nat inside source list ACL_NAT_HOME_NETWORK interface GigabitEthernet0/0/0 overload
</span><span id=__span-21-70><a id=__codelineno-21-70 name=__codelineno-21-70 href=#__codelineno-21-70></a>
</span><span id=__span-21-71><a id=__codelineno-21-71 name=__codelineno-21-71 href=#__codelineno-21-71></a>! Apply the new NAT rule using the updated ACL that includes both LANs.
</span><span id=__span-21-72><a id=__codelineno-21-72 name=__codelineno-21-72 href=#__codelineno-21-72></a>ip nat inside source list ACL_NAT_TRAFFIC_ALL_LANS interface GigabitEthernet0/0/0 overload
</span><span id=__span-21-73><a id=__codelineno-21-73 name=__codelineno-21-73 href=#__codelineno-21-73></a>
</span><span id=__span-21-74><a id=__codelineno-21-74 name=__codelineno-21-74 href=#__codelineno-21-74></a>! Exit configuration mode
</span><span id=__span-21-75><a id=__codelineno-21-75 name=__codelineno-21-75 href=#__codelineno-21-75></a>end
</span><span id=__span-21-76><a id=__codelineno-21-76 name=__codelineno-21-76 href=#__codelineno-21-76></a>
</span><span id=__span-21-77><a id=__codelineno-21-77 name=__codelineno-21-77 href=#__codelineno-21-77></a>! Save the running configuration to the startup configuration
</span><span id=__span-21-78><a id=__codelineno-21-78 name=__codelineno-21-78 href=#__codelineno-21-78></a>copy running-config startup-config
</span><span id=__span-21-79><a id=__codelineno-21-79 name=__codelineno-21-79 href=#__codelineno-21-79></a>! or &quot;write memory&quot;
</span></code></pre></div> <h4 id=c3560-configuration-steps-minimal-initial-setup>C3560 Configuration Steps (Minimal Initial Setup)<a class=headerlink href=#c3560-configuration-steps-minimal-initial-setup title="Permanent link">&para;</a></h4> <ul> <li> <p>Connect to the C3560 via console cable.</p> </li> <li> <p>If it has a previous configuration you want to wipe:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a>enable
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>write erase
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a>reload
</span></code></pre></div> <p>(Answer "no" to initial configuration dialog if it appears after reload).</p> </li> <li> <p>Configure the switch with the following commands:</p> </li> </ul> <div class="language-text highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a>! Enter global configuration mode
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>configure terminal
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a>! --- Basic Device Setup ---
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a>! Set the hostname for the switch
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a>hostname bifrost
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a>
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a>! Set the enable secret password (for privileged EXEC mode)
</span><span id=__span-23-9><a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a>enable secret &lt;your_strong_switch_password&gt;
</span><span id=__span-23-10><a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a>
</span><span id=__span-23-11><a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a>! Create a local user for login (more secure than just enable password)
</span><span id=__span-23-12><a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a>username &lt;your_admin_user&gt; privilege 15 secret &lt;your_admin_password_for_switch&gt;
</span><span id=__span-23-13><a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a>
</span><span id=__span-23-14><a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a>! Configure console line for local login
</span><span id=__span-23-15><a id=__codelineno-23-15 name=__codelineno-23-15 href=#__codelineno-23-15></a>line con 0
</span><span id=__span-23-16><a id=__codelineno-23-16 name=__codelineno-23-16 href=#__codelineno-23-16></a> login local
</span><span id=__span-23-17><a id=__codelineno-23-17 name=__codelineno-23-17 href=#__codelineno-23-17></a> logging synchronous ! Prevents console messages from interrupting typing
</span><span id=__span-23-18><a id=__codelineno-23-18 name=__codelineno-23-18 href=#__codelineno-23-18></a>exit
</span><span id=__span-23-19><a id=__codelineno-23-19 name=__codelineno-23-19 href=#__codelineno-23-19></a>
</span><span id=__span-23-20><a id=__codelineno-23-20 name=__codelineno-23-20 href=#__codelineno-23-20></a>! Configure VTY lines (for Telnet/SSH) for local login
</span><span id=__span-23-21><a id=__codelineno-23-21 name=__codelineno-23-21 href=#__codelineno-23-21></a>line vty 0 4 ! For the first 5 VTY lines
</span><span id=__span-23-22><a id=__codelineno-23-22 name=__codelineno-23-22 href=#__codelineno-23-22></a> login local
</span><span id=__span-23-23><a id=__codelineno-23-23 name=__codelineno-23-23 href=#__codelineno-23-23></a> transport input ssh ! Prefer SSH over Telnet. Telnet can be &quot;transport input telnet&quot; or &quot;transport input all&quot;
</span><span id=__span-23-24><a id=__codelineno-23-24 name=__codelineno-23-24 href=#__codelineno-23-24></a>exit
</span><span id=__span-23-25><a id=__codelineno-23-25 name=__codelineno-23-25 href=#__codelineno-23-25></a>! (To enable SSH, you&#39;ll also need to configure a domain name and generate crypto keys, see below)
</span><span id=__span-23-26><a id=__codelineno-23-26 name=__codelineno-23-26 href=#__codelineno-23-26></a>
</span><span id=__span-23-27><a id=__codelineno-23-27 name=__codelineno-23-27 href=#__codelineno-23-27></a>service password-encryption
</span><span id=__span-23-28><a id=__codelineno-23-28 name=__codelineno-23-28 href=#__codelineno-23-28></a>
</span><span id=__span-23-29><a id=__codelineno-23-29 name=__codelineno-23-29 href=#__codelineno-23-29></a>! Set the IP domain name (required for generating SSH keys)
</span><span id=__span-23-30><a id=__codelineno-23-30 name=__codelineno-23-30 href=#__codelineno-23-30></a>ip domain name midgard.local
</span><span id=__span-23-31><a id=__codelineno-23-31 name=__codelineno-23-31 href=#__codelineno-23-31></a>
</span><span id=__span-23-32><a id=__codelineno-23-32 name=__codelineno-23-32 href=#__codelineno-23-32></a>! Generate RSA crypto keys for SSH
</span><span id=__span-23-33><a id=__codelineno-23-33 name=__codelineno-23-33 href=#__codelineno-23-33></a>crypto key generate rsa modulus 2048 ! 1024 is usually sufficient for lab, 2048 for better security
</span><span id=__span-23-34><a id=__codelineno-23-34 name=__codelineno-23-34 href=#__codelineno-23-34></a>
</span><span id=__span-23-35><a id=__codelineno-23-35 name=__codelineno-23-35 href=#__codelineno-23-35></a>! --- Homelab VLAN Definition on Switch ---
</span><span id=__span-23-36><a id=__codelineno-23-36 name=__codelineno-23-36 href=#__codelineno-23-36></a>! Create VLAN 10 on the switch
</span><span id=__span-23-37><a id=__codelineno-23-37 name=__codelineno-23-37 href=#__codelineno-23-37></a>vlan 10
</span><span id=__span-23-38><a id=__codelineno-23-38 name=__codelineno-23-38 href=#__codelineno-23-38></a> ! Assign a descriptive name to VLAN 10 (should match C1111 for clarity)
</span><span id=__span-23-39><a id=__codelineno-23-39 name=__codelineno-23-39 href=#__codelineno-23-39></a> name HOMELAB_SERVERS
</span><span id=__span-23-40><a id=__codelineno-23-40 name=__codelineno-23-40 href=#__codelineno-23-40></a>exit
</span><span id=__span-23-41><a id=__codelineno-23-41 name=__codelineno-23-41 href=#__codelineno-23-41></a>
</span><span id=__span-23-42><a id=__codelineno-23-42 name=__codelineno-23-42 href=#__codelineno-23-42></a>! --- Switch Virtual Interface (SVI) for Management ---
</span><span id=__span-23-43><a id=__codelineno-23-43 name=__codelineno-23-43 href=#__codelineno-23-43></a>! Create a virtual interface representing VLAN 10 for switch management
</span><span id=__span-23-44><a id=__codelineno-23-44 name=__codelineno-23-44 href=#__codelineno-23-44></a>interface Vlan10
</span><span id=__span-23-45><a id=__codelineno-23-45 name=__codelineno-23-45 href=#__codelineno-23-45></a> ! Add a description for this management interface
</span><span id=__span-23-46><a id=__codelineno-23-46 name=__codelineno-23-46 href=#__codelineno-23-46></a> description Management_IP_for_Switch_VLAN10
</span><span id=__span-23-47><a id=__codelineno-23-47 name=__codelineno-23-47 href=#__codelineno-23-47></a> ! Assign an IP address and subnet mask to this SVI. This IP is used to manage the switch.
</span><span id=__span-23-48><a id=__codelineno-23-48 name=__codelineno-23-48 href=#__codelineno-23-48></a> ip address 10.10.10.2 255.255.255.0
</span><span id=__span-23-49><a id=__codelineno-23-49 name=__codelineno-23-49 href=#__codelineno-23-49></a> ! Ensure the interface is administratively up
</span><span id=__span-23-50><a id=__codelineno-23-50 name=__codelineno-23-50 href=#__codelineno-23-50></a> no shutdown
</span><span id=__span-23-51><a id=__codelineno-23-51 name=__codelineno-23-51 href=#__codelineno-23-51></a>exit
</span><span id=__span-23-52><a id=__codelineno-23-52 name=__codelineno-23-52 href=#__codelineno-23-52></a>
</span><span id=__span-23-53><a id=__codelineno-23-53 name=__codelineno-23-53 href=#__codelineno-23-53></a>! --- Set Default Gateway for Switch Management ---
</span><span id=__span-23-54><a id=__codelineno-23-54 name=__codelineno-23-54 href=#__codelineno-23-54></a>! Configure the default gateway for the switch itself (for management traffic, e.g., NTP, AAA, SSH from other networks)
</span><span id=__span-23-55><a id=__codelineno-23-55 name=__codelineno-23-55 href=#__codelineno-23-55></a>! This IP should be the SVI IP of VLAN 10 on the C1111 router.
</span><span id=__span-23-56><a id=__codelineno-23-56 name=__codelineno-23-56 href=#__codelineno-23-56></a>ip default-gateway 10.10.10.1
</span><span id=__span-23-57><a id=__codelineno-23-57 name=__codelineno-23-57 href=#__codelineno-23-57></a>
</span><span id=__span-23-58><a id=__codelineno-23-58 name=__codelineno-23-58 href=#__codelineno-23-58></a>! --- Port Configuration for Uplink to C1111 Router ---
</span><span id=__span-23-59><a id=__codelineno-23-59 name=__codelineno-23-59 href=#__codelineno-23-59></a>! Select the physical port on the C3560 that connects to the C1111
</span><span id=__span-23-60><a id=__codelineno-23-60 name=__codelineno-23-60 href=#__codelineno-23-60></a>interface GigabitEthernet0/9 ! Or your chosen uplink port (e.g., Gi0/1 if it&#39;s a different model/slot)
</span><span id=__span-23-61><a id=__codelineno-23-61 name=__codelineno-23-61 href=#__codelineno-23-61></a> ! Add a description for this port
</span><span id=__span-23-62><a id=__codelineno-23-62 name=__codelineno-23-62 href=#__codelineno-23-62></a> description Uplink_To_C1111_Router_VLAN10
</span><span id=__span-23-63><a id=__codelineno-23-63 name=__codelineno-23-63 href=#__codelineno-23-63></a> ! Set the port to access mode
</span><span id=__span-23-64><a id=__codelineno-23-64 name=__codelineno-23-64 href=#__codelineno-23-64></a> switchport mode access
</span><span id=__span-23-65><a id=__codelineno-23-65 name=__codelineno-23-65 href=#__codelineno-23-65></a> ! Assign this access port to VLAN 10
</span><span id=__span-23-66><a id=__codelineno-23-66 name=__codelineno-23-66 href=#__codelineno-23-66></a> switchport access vlan 10
</span><span id=__span-23-67><a id=__codelineno-23-67 name=__codelineno-23-67 href=#__codelineno-23-67></a> ! (PortFast might not be strictly necessary here if this is an uplink to another switch/router,
</span><span id=__span-23-68><a id=__codelineno-23-68 name=__codelineno-23-68 href=#__codelineno-23-68></a> !  but for a simple P2P link in access mode to the router&#39;s access port, it&#39;s generally safe.
</span><span id=__span-23-69><a id=__codelineno-23-69 name=__codelineno-23-69 href=#__codelineno-23-69></a> !  If you were trunking, you would not use PortFast on a trunk to another switch.)
</span><span id=__span-23-70><a id=__codelineno-23-70 name=__codelineno-23-70 href=#__codelineno-23-70></a> ! spanning-tree portfast
</span><span id=__span-23-71><a id=__codelineno-23-71 name=__codelineno-23-71 href=#__codelineno-23-71></a> ! Ensure the physical port is administratively up
</span><span id=__span-23-72><a id=__codelineno-23-72 name=__codelineno-23-72 href=#__codelineno-23-72></a> no shutdown
</span><span id=__span-23-73><a id=__codelineno-23-73 name=__codelineno-23-73 href=#__codelineno-23-73></a>exit
</span><span id=__span-23-74><a id=__codelineno-23-74 name=__codelineno-23-74 href=#__codelineno-23-74></a>
</span><span id=__span-23-75><a id=__codelineno-23-75 name=__codelineno-23-75 href=#__codelineno-23-75></a>! (Optional: Configure other switchports for future devices in VLAN 10 later in Stage 3)
</span><span id=__span-23-76><a id=__codelineno-23-76 name=__codelineno-23-76 href=#__codelineno-23-76></a>! Example:
</span><span id=__span-23-77><a id=__codelineno-23-77 name=__codelineno-23-77 href=#__codelineno-23-77></a>! interface range GigabitEthernet0/1 - 8
</span><span id=__span-23-78><a id=__codelineno-23-78 name=__codelineno-23-78 href=#__codelineno-23-78></a>!  switchport mode access
</span><span id=__span-23-79><a id=__codelineno-23-79 name=__codelineno-23-79 href=#__codelineno-23-79></a>!  switchport access vlan 10
</span><span id=__span-23-80><a id=__codelineno-23-80 name=__codelineno-23-80 href=#__codelineno-23-80></a>!  spanning-tree portfast
</span><span id=__span-23-81><a id=__codelineno-23-81 name=__codelineno-23-81 href=#__codelineno-23-81></a>!  no shutdown
</span><span id=__span-23-82><a id=__codelineno-23-82 name=__codelineno-23-82 href=#__codelineno-23-82></a>! exit
</span><span id=__span-23-83><a id=__codelineno-23-83 name=__codelineno-23-83 href=#__codelineno-23-83></a>
</span><span id=__span-23-84><a id=__codelineno-23-84 name=__codelineno-23-84 href=#__codelineno-23-84></a>! dns resolution
</span><span id=__span-23-85><a id=__codelineno-23-85 name=__codelineno-23-85 href=#__codelineno-23-85></a>ip name-server 1.1.1.1
</span><span id=__span-23-86><a id=__codelineno-23-86 name=__codelineno-23-86 href=#__codelineno-23-86></a>ip name-server 8.8.8.8
</span><span id=__span-23-87><a id=__codelineno-23-87 name=__codelineno-23-87 href=#__codelineno-23-87></a>ip domain-lookup source-interface Vlan10
</span><span id=__span-23-88><a id=__codelineno-23-88 name=__codelineno-23-88 href=#__codelineno-23-88></a>
</span><span id=__span-23-89><a id=__codelineno-23-89 name=__codelineno-23-89 href=#__codelineno-23-89></a>! ntp
</span><span id=__span-23-90><a id=__codelineno-23-90 name=__codelineno-23-90 href=#__codelineno-23-90></a>clock timezone UTC 0 0           ! Or your local timezone
</span><span id=__span-23-91><a id=__codelineno-23-91 name=__codelineno-23-91 href=#__codelineno-23-91></a>ntp server 0.pool.ntp.org prefer
</span><span id=__span-23-92><a id=__codelineno-23-92 name=__codelineno-23-92 href=#__codelineno-23-92></a>ntp server 1.pool.ntp.org
</span><span id=__span-23-93><a id=__codelineno-23-93 name=__codelineno-23-93 href=#__codelineno-23-93></a>ntp server 2.pool.ntp.org
</span><span id=__span-23-94><a id=__codelineno-23-94 name=__codelineno-23-94 href=#__codelineno-23-94></a>
</span><span id=__span-23-95><a id=__codelineno-23-95 name=__codelineno-23-95 href=#__codelineno-23-95></a>! optional, disable VTP if not needed
</span><span id=__span-23-96><a id=__codelineno-23-96 name=__codelineno-23-96 href=#__codelineno-23-96></a>vtp mode off
</span><span id=__span-23-97><a id=__codelineno-23-97 name=__codelineno-23-97 href=#__codelineno-23-97></a>
</span><span id=__span-23-98><a id=__codelineno-23-98 name=__codelineno-23-98 href=#__codelineno-23-98></a>! Exit configuration mode
</span><span id=__span-23-99><a id=__codelineno-23-99 name=__codelineno-23-99 href=#__codelineno-23-99></a>end
</span><span id=__span-23-100><a id=__codelineno-23-100 name=__codelineno-23-100 href=#__codelineno-23-100></a>
</span><span id=__span-23-101><a id=__codelineno-23-101 name=__codelineno-23-101 href=#__codelineno-23-101></a>! Save the running configuration to the startup configuration
</span><span id=__span-23-102><a id=__codelineno-23-102 name=__codelineno-23-102 href=#__codelineno-23-102></a>copy running-config startup-config
</span><span id=__span-23-103><a id=__codelineno-23-103 name=__codelineno-23-103 href=#__codelineno-23-103></a>! or &quot;write memory&quot;
</span></code></pre></div> <h4 id=optional-controller-pc-ssh-configuration>(Optional) Controller PC ssh configuration<a class=headerlink href=#optional-controller-pc-ssh-configuration title="Permanent link">&para;</a></h4> <ul> <li>Ensure the following ssh configuration is present in <code>~/.ssh/config</code>:</li> </ul> <div class="language-text highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a># &#39;muspell&#39; C1111 router in homelab vlan
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>Host 10.10.10.1 muspell
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a>  User &lt;your_admin_user&gt;
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a># &#39;bifrost&#39; C3560 switch in homelab vlan
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>Host 10.10.10.2 bifrost
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a>  User &lt;your_admin_user&gt;
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a>  KexAlgorithms +diffie-hellman-group14-sha1
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>  HostKeyAlgorithms +ssh-rsa
</span></code></pre></div> <ul> <li>See <a href=#ssh-error-no-matching-key-exchange-method-found>'no matching key exchange method found'</a> and <a href=#ssh-error-no-matching-host-key-type-found>'no matching host key type found'</a> ssh troubleshooting info for more details.</li> </ul> <h4 id=verification-steps_1>Verification Steps<a class=headerlink href=#verification-steps_1 title="Permanent link">&para;</a></h4> <ul> <li><strong>Physical Connectivity:</strong> Ensure the cable between C1111 (<code>Gi0/1/1</code>) and C3560 (<code>Gi0/9</code>) is securely connected.</li> <li><strong>On C1111 Router:</strong><ul> <li><code>show ip interface brief</code>:<ul> <li><code>Vlan10</code> should be <code>up</code>, <code>up</code>, protocol <code>up</code>, IP <code>10.10.10.1</code>.</li> <li><code>GigabitEthernet0/1/1</code> should be <code>up</code>, <code>up</code>, protocol <code>up</code>.</li> </ul> </li> <li><code>show vlan brief</code>: Should show VLAN 10 "HOMELAB_SERVERS" active with port <code>Gi0/1/1</code> assigned.</li> <li><code>show cdp neighbors</code>: You should see the C3560-Homelab-Switch listed on <code>GigabitEthernet0/1/1</code>.</li> <li><code>ping 10.10.10.2</code>: Try pinging the C3560's management IP. This tests L3 connectivity from C1111 to C3560 SVI.</li> </ul> </li> <li><strong>On C3560 Switch:</strong><ul> <li><code>show ip interface brief</code>:<ul> <li><code>Vlan10</code> should be <code>up</code>, <code>up</code>, protocol <code>up</code>, IP <code>10.10.10.2</code>.</li> <li><code>GigabitEthernet0/9</code> (or your uplink port) should be <code>up</code>, <code>up</code>, protocol <code>up</code>.</li> </ul> </li> <li><code>show vlan brief</code>: Should show VLAN 10 "HOMELAB_SERVERS" active with port <code>Gi0/9</code> (uplink) assigned.</li> <li><code>show cdp neighbors</code>: You should see the C1111-Router listed on <code>GigabitEthernet0/9</code>.</li> <li><code>ping 10.10.10.1</code>: Try pinging the C1111's SVI for VLAN 10. This tests L3 connectivity from C3560 to C1111.</li> <li><code>ping 1.1.1.1</code> (or any public IP): This tests if the C3560 can reach the internet (requires the NAT update on C1111 to be effective).</li> <li><code>ping google.com</code>: Test DNS resolution on the switch.</li> <li>Verify ntp status is synchronized, check ntp associations <div class="language-text highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a>sh clock
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>14:31:38.416 UTC Wed Jun 11 2025
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a>sh ntp status
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>Clock is synchronized, stratum 3, reference is 82.148.168.42
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a>nominal freq is 250.0000 Hz, actual freq is 249.9955 Hz, precision is 2**10
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a>ntp uptime is 132400 (1/100 of seconds), resolution is 4016
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a>reference time is EBF411C2.FB22D398 (14:31:30.981 UTC Wed Jun 11 2025)
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a>clock offset is 0.6257 msec, root delay is 10.39 msec
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a>root dispersion is 7941.97 msec, peer dispersion is 188.53 msec
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a>loopfilter state is &#39;CTRL&#39; (Normal Controlled Loop), drift is 0.000018037 s/s
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a>system poll interval is 64, last update was 13 sec ago.
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a>sh ntp associations
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>  address         ref clock       st   when   poll reach  delay  offset   disp
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a>*~82.148.168.42   62.92.229.27     2     48     64     1  1.913   0.625 188.53
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a>+~192.36.143.130  .PPS.            1     59     64     1 13.999  -1.548 7937.9
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a>+~77.104.162.218  .PPS.            1     58     64     1 47.970  -3.393 7937.9
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a> * sys.peer, # selected, + candidate, - outlyer, x falseticker, ~ configured
</span></code></pre></div></li> </ul> </li> <li><strong>From a device on your Home Network (e.g., the controller laptop on <code>192.168.1.x</code>):</strong><ul> <li><code>ping 10.10.10.1</code>: Ping the C1111's Homelab VLAN gateway.</li> <li><code>ping 10.10.10.2</code>: Ping the C3560 switch's management IP.<ul> <li><em>Note:</em> This inter-VLAN ping will work because the C1111 routes between directly connected networks (<code>Vlan2</code> and <code>Vlan10</code>). No specific ACLs are blocking it yet (those come in <a href=#stage-4>stage 4</a>).</li> </ul> </li> <li>Try to SSH to <code>10.10.10.1</code> (the C1111 router) using the admin credentials you set up for the router.</li> <li>Try to SSH to <code>10.10.10.2</code> (the C3560 switch) using the admin credentials you set up for the switch.</li> </ul> </li> </ul> <h3 id=stage-3>Stage 3 - Connect k8s Nodes and NAS to Homelab VLAN &amp; Enable DHCP<a class=headerlink href=#stage-3 title="Permanent link">&para;</a></h3> <ul> <li> <p><strong>Goal:</strong> K8s nodes and NAS are physically connected to the C3560, obtain IPs (or have static IPs configured correctly) in the <code>10.10.10.0/24</code> range, and can access the internet (assuming NAT on C1111 from Stage 2 is working).</p> </li> <li> <p><strong>Physical Connection:</strong> Connect your k8s nodes and NAS device to available ports on the C3560 switch (e.g., <code>GigabitEthernet0/1</code> through <code>GigabitEthernet0/8</code>).</p> </li> </ul> <h4 id=c1111-configuration-steps_2>C1111 Configuration Steps<a class=headerlink href=#c1111-configuration-steps_2 title="Permanent link">&para;</a></h4> <div class="language-text highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a>! Enter global configuration mode
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>configure terminal
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>! --- DHCP Server Configuration for Homelab Network (VLAN 10) ---
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a>! This pool will serve IP addresses to devices in the Homelab VLAN.
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>! Define a range of IP addresses to EXCLUDE from being dynamically assigned by DHCP.
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a>! These are typically for static assignments (router SVI, switch management IP, servers, MetalLB range, etc.)
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>ip dhcp excluded-address 10.10.10.1 10.10.10.9      ! Exclude C1111&#39;s Vlan10 SVI (10.10.10.1) and C3560&#39;s Mgmt IP (10.10.10.2) and reserve a few more addresses for similar purposes (APs etc)
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a>! Exclude IPs you plan to assign to your k8s nodes and NAS.
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a>! Example:
</span><span id=__span-28-13><a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a>!   Control: 10.10.10.1x
</span><span id=__span-28-14><a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a>!   Workers: 10.10.10.2x
</span><span id=__span-28-15><a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a>!   Storage: 10.10.10.3x
</span><span id=__span-28-16><a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a>!   MetalLb: 10.10.10.4x - 10.10.10.6x
</span><span id=__span-28-17><a id=__codelineno-28-17 name=__codelineno-28-17 href=#__codelineno-28-17></a>ip dhcp excluded-address 10.10.10.10 10.10.10.19    ! k8s control plane nodes
</span><span id=__span-28-18><a id=__codelineno-28-18 name=__codelineno-28-18 href=#__codelineno-28-18></a>ip dhcp excluded-address 10.10.10.20 10.10.10.29    ! k8s worker nodes
</span><span id=__span-28-19><a id=__codelineno-28-19 name=__codelineno-28-19 href=#__codelineno-28-19></a>ip dhcp excluded-address 10.10.10.30 10.10.10.39    ! storage nodes
</span><span id=__span-28-20><a id=__codelineno-28-20 name=__codelineno-28-20 href=#__codelineno-28-20></a>
</span><span id=__span-28-21><a id=__codelineno-28-21 name=__codelineno-28-21 href=#__codelineno-28-21></a>! Exclude the IP range you plan to use for LoadBalancer
</span><span id=__span-28-22><a id=__codelineno-28-22 name=__codelineno-28-22 href=#__codelineno-28-22></a>! This range should NOT overlap with any static or DHCP-assigned IPs.
</span><span id=__span-28-23><a id=__codelineno-28-23 name=__codelineno-28-23 href=#__codelineno-28-23></a>ip dhcp excluded-address 10.10.10.40 10.10.10.69    ! LB IP pool
</span><span id=__span-28-24><a id=__codelineno-28-24 name=__codelineno-28-24 href=#__codelineno-28-24></a>
</span><span id=__span-28-25><a id=__codelineno-28-25 name=__codelineno-28-25 href=#__codelineno-28-25></a>! Define the DHCP pool for the Homelab network
</span><span id=__span-28-26><a id=__codelineno-28-26 name=__codelineno-28-26 href=#__codelineno-28-26></a>ip dhcp pool HOMELAB_POOL_VLAN10
</span><span id=__span-28-27><a id=__codelineno-28-27 name=__codelineno-28-27 href=#__codelineno-28-27></a> ! Specify the network address and subnet mask for this DHCP pool
</span><span id=__span-28-28><a id=__codelineno-28-28 name=__codelineno-28-28 href=#__codelineno-28-28></a> network 10.10.10.0 255.255.255.0
</span><span id=__span-28-29><a id=__codelineno-28-29 name=__codelineno-28-29 href=#__codelineno-28-29></a> ! Specify the default gateway IP address for DHCP clients (C1111&#39;s SVI for VLAN 10)
</span><span id=__span-28-30><a id=__codelineno-28-30 name=__codelineno-28-30 href=#__codelineno-28-30></a> default-router 10.10.10.1
</span><span id=__span-28-31><a id=__codelineno-28-31 name=__codelineno-28-31 href=#__codelineno-28-31></a> ! Specify DNS server(s) for DHCP clients.
</span><span id=__span-28-32><a id=__codelineno-28-32 name=__codelineno-28-32 href=#__codelineno-28-32></a> ! Start with public DNS. Later, you might change this to your internal DNS server (e.g., Pi-hole).
</span><span id=__span-28-33><a id=__codelineno-28-33 name=__codelineno-28-33 href=#__codelineno-28-33></a> dns-server 1.1.1.1 8.8.8.8
</span><span id=__span-28-34><a id=__codelineno-28-34 name=__codelineno-28-34 href=#__codelineno-28-34></a> ! Specify the domain name to be provided to DHCP clients (should match global ip domain name for consistency)
</span><span id=__span-28-35><a id=__codelineno-28-35 name=__codelineno-28-35 href=#__codelineno-28-35></a> domain-name midgard.local
</span><span id=__span-28-36><a id=__codelineno-28-36 name=__codelineno-28-36 href=#__codelineno-28-36></a> ! Specify the lease duration for IP addresses (e.g., 1 day)
</span><span id=__span-28-37><a id=__codelineno-28-37 name=__codelineno-28-37 href=#__codelineno-28-37></a> lease 1
</span><span id=__span-28-38><a id=__codelineno-28-38 name=__codelineno-28-38 href=#__codelineno-28-38></a>exit
</span><span id=__span-28-39><a id=__codelineno-28-39 name=__codelineno-28-39 href=#__codelineno-28-39></a>
</span><span id=__span-28-40><a id=__codelineno-28-40 name=__codelineno-28-40 href=#__codelineno-28-40></a>! Use &#39;interface range&#39; to configure multiple ports simultaneously.
</span><span id=__span-28-41><a id=__codelineno-28-41 name=__codelineno-28-41 href=#__codelineno-28-41></a>interface range GigabitEthernet0/1/2 - 7 ! configure extra ports on the router for your servers/NAS
</span><span id=__span-28-42><a id=__codelineno-28-42 name=__codelineno-28-42 href=#__codelineno-28-42></a> ! Add a generic description for these device ports
</span><span id=__span-28-43><a id=__codelineno-28-43 name=__codelineno-28-43 href=#__codelineno-28-43></a> description Homelab_Server_Device_Port_VLAN10
</span><span id=__span-28-44><a id=__codelineno-28-44 name=__codelineno-28-44 href=#__codelineno-28-44></a> ! Set the ports to access mode, as they will carry traffic for a single VLAN (VLAN 10)
</span><span id=__span-28-45><a id=__codelineno-28-45 name=__codelineno-28-45 href=#__codelineno-28-45></a> switchport mode access
</span><span id=__span-28-46><a id=__codelineno-28-46 name=__codelineno-28-46 href=#__codelineno-28-46></a> ! Assign these access ports to VLAN 10
</span><span id=__span-28-47><a id=__codelineno-28-47 name=__codelineno-28-47 href=#__codelineno-28-47></a> switchport access vlan 10
</span><span id=__span-28-48><a id=__codelineno-28-48 name=__codelineno-28-48 href=#__codelineno-28-48></a> ! Enable PortFast: causes Layer 2 access ports to enter the forwarding state immediately.
</span><span id=__span-28-49><a id=__codelineno-28-49 name=__codelineno-28-49 href=#__codelineno-28-49></a> ! Use only on ports connected to end devices (like servers/NAS) to avoid STP delays.
</span><span id=__span-28-50><a id=__codelineno-28-50 name=__codelineno-28-50 href=#__codelineno-28-50></a> spanning-tree portfast
</span><span id=__span-28-51><a id=__codelineno-28-51 name=__codelineno-28-51 href=#__codelineno-28-51></a> ! Ensure the physical ports are administratively up
</span><span id=__span-28-52><a id=__codelineno-28-52 name=__codelineno-28-52 href=#__codelineno-28-52></a> no shutdown
</span><span id=__span-28-53><a id=__codelineno-28-53 name=__codelineno-28-53 href=#__codelineno-28-53></a>exit
</span><span id=__span-28-54><a id=__codelineno-28-54 name=__codelineno-28-54 href=#__codelineno-28-54></a>
</span><span id=__span-28-55><a id=__codelineno-28-55 name=__codelineno-28-55 href=#__codelineno-28-55></a>! Exit configuration mode
</span><span id=__span-28-56><a id=__codelineno-28-56 name=__codelineno-28-56 href=#__codelineno-28-56></a>end
</span><span id=__span-28-57><a id=__codelineno-28-57 name=__codelineno-28-57 href=#__codelineno-28-57></a>
</span><span id=__span-28-58><a id=__codelineno-28-58 name=__codelineno-28-58 href=#__codelineno-28-58></a>! Save the running configuration to the startup configuration
</span><span id=__span-28-59><a id=__codelineno-28-59 name=__codelineno-28-59 href=#__codelineno-28-59></a>copy running-config startup-config
</span><span id=__span-28-60><a id=__codelineno-28-60 name=__codelineno-28-60 href=#__codelineno-28-60></a>! or &quot;write memory&quot;
</span></code></pre></div> <h4 id=c3560-configuration-steps>C3560 Configuration Steps<a class=headerlink href=#c3560-configuration-steps title="Permanent link">&para;</a></h4> <div class="language-text highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a>! Enter global configuration mode
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>configure terminal
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a>! --- Port Configuration for K8s Nodes and NAS ---
</span><span id=__span-29-5><a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a>! Configure the switchports that your K8s nodes and NAS will connect to.
</span><span id=__span-29-6><a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a>! This example uses ports Gi0/1 through Gi0/8. Adjust the range as needed.
</span><span id=__span-29-7><a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a>
</span><span id=__span-29-8><a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a>! Use &#39;interface range&#39; to configure multiple ports simultaneously.
</span><span id=__span-29-9><a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a>interface range GigabitEthernet0/1 - 8 ! Assuming these are the ports for your servers/NAS
</span><span id=__span-29-10><a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a> ! Add a generic description for these device ports
</span><span id=__span-29-11><a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a> description Homelab_Server_Device_Port_VLAN10
</span><span id=__span-29-12><a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a> ! Set the ports to access mode, as they will carry traffic for a single VLAN (VLAN 10)
</span><span id=__span-29-13><a id=__codelineno-29-13 name=__codelineno-29-13 href=#__codelineno-29-13></a> switchport mode access
</span><span id=__span-29-14><a id=__codelineno-29-14 name=__codelineno-29-14 href=#__codelineno-29-14></a> ! Assign these access ports to VLAN 10
</span><span id=__span-29-15><a id=__codelineno-29-15 name=__codelineno-29-15 href=#__codelineno-29-15></a> switchport access vlan 10
</span><span id=__span-29-16><a id=__codelineno-29-16 name=__codelineno-29-16 href=#__codelineno-29-16></a> ! Enable PortFast: causes Layer 2 access ports to enter the forwarding state immediately.
</span><span id=__span-29-17><a id=__codelineno-29-17 name=__codelineno-29-17 href=#__codelineno-29-17></a> ! Use only on ports connected to end devices (like servers/NAS) to avoid STP delays.
</span><span id=__span-29-18><a id=__codelineno-29-18 name=__codelineno-29-18 href=#__codelineno-29-18></a> spanning-tree portfast
</span><span id=__span-29-19><a id=__codelineno-29-19 name=__codelineno-29-19 href=#__codelineno-29-19></a> ! Ensure the physical ports are administratively up
</span><span id=__span-29-20><a id=__codelineno-29-20 name=__codelineno-29-20 href=#__codelineno-29-20></a> no shutdown
</span><span id=__span-29-21><a id=__codelineno-29-21 name=__codelineno-29-21 href=#__codelineno-29-21></a>exit
</span><span id=__span-29-22><a id=__codelineno-29-22 name=__codelineno-29-22 href=#__codelineno-29-22></a>
</span><span id=__span-29-23><a id=__codelineno-29-23 name=__codelineno-29-23 href=#__codelineno-29-23></a>! Configure Gi0/10 as an additional port with Vlan 10 access
</span><span id=__span-29-24><a id=__codelineno-29-24 name=__codelineno-29-24 href=#__codelineno-29-24></a>! Can be used to e.g. connect a laptop to Vlan 10 directly for PXE-boot provisioning
</span><span id=__span-29-25><a id=__codelineno-29-25 name=__codelineno-29-25 href=#__codelineno-29-25></a>interface GigabitEthernet0/10
</span><span id=__span-29-26><a id=__codelineno-29-26 name=__codelineno-29-26 href=#__codelineno-29-26></a>  description &quot;Homelab additional device port VLAN10&quot;
</span><span id=__span-29-27><a id=__codelineno-29-27 name=__codelineno-29-27 href=#__codelineno-29-27></a>  switchport mode access
</span><span id=__span-29-28><a id=__codelineno-29-28 name=__codelineno-29-28 href=#__codelineno-29-28></a>  switchport access vlan 10
</span><span id=__span-29-29><a id=__codelineno-29-29 name=__codelineno-29-29 href=#__codelineno-29-29></a>  spanning-tree portfast
</span><span id=__span-29-30><a id=__codelineno-29-30 name=__codelineno-29-30 href=#__codelineno-29-30></a>  no shutdown
</span><span id=__span-29-31><a id=__codelineno-29-31 name=__codelineno-29-31 href=#__codelineno-29-31></a>exit
</span><span id=__span-29-32><a id=__codelineno-29-32 name=__codelineno-29-32 href=#__codelineno-29-32></a>
</span><span id=__span-29-33><a id=__codelineno-29-33 name=__codelineno-29-33 href=#__codelineno-29-33></a>! Exit configuration mode
</span><span id=__span-29-34><a id=__codelineno-29-34 name=__codelineno-29-34 href=#__codelineno-29-34></a>end
</span><span id=__span-29-35><a id=__codelineno-29-35 name=__codelineno-29-35 href=#__codelineno-29-35></a>
</span><span id=__span-29-36><a id=__codelineno-29-36 name=__codelineno-29-36 href=#__codelineno-29-36></a>! Save the running configuration to the startup configuration
</span><span id=__span-29-37><a id=__codelineno-29-37 name=__codelineno-29-37 href=#__codelineno-29-37></a>copy running-config startup-config
</span><span id=__span-29-38><a id=__codelineno-29-38 name=__codelineno-29-38 href=#__codelineno-29-38></a>! or &quot;write memory&quot;
</span></code></pre></div> <h4 id=optional-k8s-nodes-nas-device-network-configuration>(Optional) K8s Nodes &amp; NAS Device Network Configuration<a class=headerlink href=#optional-k8s-nodes-nas-device-network-configuration title="Permanent link">&para;</a></h4> <div class="admonition info"> <p class=admonition-title>Info</p> <p>This is an optional step and can usually be skipped. However, if you already have your nodes with some pre-installed OS on them, you can use follow the following steps and test the connectivity. <br> This part is done on the operating system of each server. The method varies by OS (Linux distribution type, etc.).</p> </div> <ul> <li> <p><strong>Physical Connection:</strong></p> <ul> <li>Connect each K8s node (Control 1-3, Worker 1-4) to one of the C3560 switchports you just configured (e.g., <code>Gi0/1</code> through <code>Gi0/8</code>).</li> </ul> </li> <li> <p><strong>IP Configuration on Devices:</strong> You have two main options:</p> <ul> <li> <p><strong>Option A: Static IP Configuration (Recommended for Servers/NAS/K8s Nodes):</strong></p> <ul> <li>Manually configure the network interface on each device.</li> <li><strong>Example for K8s Control 1 (<code>10.10.10.10</code>):</strong><ul> <li>IP Address: <code>10.10.10.10</code></li> <li>Subnet Mask: <code>255.255.255.0</code> (or <code>/24</code>)</li> <li>Gateway: <code>10.10.10.1</code> (C1111's SVI for VLAN 10)</li> <li>DNS Server 1: <code>1.1.1.1</code> (or your future internal DNS IP)</li> <li>DNS Server 2: <code>8.8.8.8</code> (optional)</li> </ul> </li> <li>Repeat for all K8s nodes and the NAS, using their designated static IPs (which you excluded from DHCP on the C1111).</li> </ul> </li> <li> <p><strong>Option B: DHCP Client Configuration (Less common for servers, but possible):</strong></p> <ul> <li>Configure the network interface on each device to obtain an IP address automatically via DHCP.</li> <li>If you use this, the device will get an IP from the <code>HOMELAB_POOL_VLAN10</code> range <em>that is not in the excluded list</em>.</li> <li>For consistent IPs with DHCP, you would typically set up DHCP reservations (MAC address to IP mapping) on the C1111. This is more advanced and can be added later if desired. For now, static configuration on the end devices is simpler if you want specific IPs.</li> </ul> </li> </ul> </li> </ul> <h4 id=verification-steps_2>Verification Steps<a class=headerlink href=#verification-steps_2 title="Permanent link">&para;</a></h4> <ul> <li><strong>On C1111 Router:</strong><ul> <li>If any of your K8s/NAS devices are configured for DHCP (and not in the excluded list), check bindings: <code>show ip dhcp binding</code> - You should see any devices that successfully got an IP via DHCP from the <code>HOMELAB_POOL_VLAN10</code>.</li> </ul> </li> <li><strong>On C3560 Switch:</strong><ul> <li><code>show mac address-table vlan 10</code>: You should see the MAC addresses of your connected K8s nodes and NAS learned on their respective switchports (e.g., <code>Gi0/1</code>, <code>Gi0/2</code>, etc.).</li> <li><code>show interfaces status</code>: Verify that the ports connected to your K8s nodes/NAS are <code>connected</code> and in <code>vlan 10</code>.</li> </ul> </li> <li><strong>On each K8s Node and NAS Device:</strong><ul> <li><strong>Verify IP Configuration:</strong><ul> <li>Linux: <code>ip addr show &lt;interface_name&gt;</code> or <code>ifconfig &lt;interface_name&gt;</code></li> <li>NAS: Check network settings in its web UI.</li> <li>Confirm the IP, subnet mask, gateway, and DNS servers are correctly set (either statically or received via DHCP).</li> </ul> </li> <li><strong>Test Gateway Connectivity:</strong><ul> <li><code>ping 10.10.10.1</code> (Should reply from C1111's Vlan10 SVI).</li> </ul> </li> <li><strong>Test Internet Connectivity:</strong><ul> <li><code>ping 1.1.1.1</code> (or any public IP like <code>8.8.8.8</code>).</li> <li><code>ping google.com</code> (Tests both internet and DNS resolution).</li> </ul> </li> <li><strong>Test DNS Resolution (if using public DNS for now):</strong><ul> <li>Linux: <code>nslookup google.com</code> or <code>dig google.com</code></li> <li>Confirm it resolves to public IP addresses.</li> </ul> </li> </ul> </li> <li><strong>From a device on your Home Network (e.g., laptop on <code>192.168.1.x</code>):</strong><ul> <li><code>ping 10.10.10.10</code> (Ping K8s Control 1).</li> <li><code>ping 10.10.10.20</code> (Ping K8s Worker 1).<ul> <li>These pings should work because the C1111 routes between VLAN 2 and VLAN 10 by default, and no restrictive ACLs are in place yet.</li> </ul> </li> </ul> </li> <li>Connect a PC to the <code>g0/10</code> port on the C3560 switch<ul> <li><code>ifconfig</code> should show an interface with <code>10.10.10.x</code> IP, e.g. <div class="language-bash highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a>$<span class=w> </span>ifconfig
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>foobarbaz:<span class=w> </span><span class=nv>flags</span><span class=o>=</span><span class=m>4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;<span class=w>  </span>mtu<span class=w> </span><span class=m>1500</span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=w>    </span>inet<span class=w> </span><span class=m>10</span>.10.10.71<span class=w>  </span>netmask<span class=w> </span><span class=m>255</span>.255.255.0<span class=w>  </span>broadcast<span class=w> </span><span class=m>10</span>.10.10.255
</span></code></pre></div></li> <li>Send a WoL magic packet to a device on homelab network <div class="language-bash highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=nv>MAC</span><span class=o>=</span><span class=s1>&#39;11:22:33:44:55:66&#39;</span><span class=w>       </span><span class=c1># mac address of the connected target device</span>
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=nv>Broadcast</span><span class=o>=</span><span class=s1>&#39;255.255.255.255&#39;</span><span class=w>   </span><span class=c1># default broadcast address</span>
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=nv>PortNumber</span><span class=o>=</span><span class=m>9</span><span class=w>                  </span><span class=c1># default port for WoL</span>
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=nb>echo</span><span class=w> </span>-e<span class=w> </span><span class=k>$(</span><span class=nb>echo</span><span class=w> </span><span class=k>$(</span><span class=nb>printf</span><span class=w> </span><span class=s1>&#39;f%.0s&#39;</span><span class=w> </span><span class=o>{</span><span class=m>1</span>..12<span class=o>}</span><span class=p>;</span><span class=w> </span><span class=nb>printf</span><span class=w> </span><span class=s2>&quot;</span><span class=k>$(</span><span class=nb>echo</span><span class=w> </span><span class=nv>$MAC</span><span class=w> </span><span class=p>|</span><span class=w> </span>sed<span class=w> </span><span class=s1>&#39;s/://g&#39;</span><span class=k>)</span><span class=s2>%.0s&quot;</span><span class=w> </span><span class=o>{</span><span class=m>1</span>..16<span class=o>}</span><span class=k>)</span><span class=w> </span><span class=p>|</span><span class=w> </span>sed<span class=w> </span>-e<span class=w> </span><span class=s1>&#39;s/../\\x&amp;/g&#39;</span><span class=k>)</span><span class=w> </span><span class=p>|</span><span class=w> </span>nc<span class=w> </span>-w1<span class=w> </span>-u<span class=w> </span>-b<span class=w> </span><span class=nv>$Broadcast</span><span class=w> </span><span class=nv>$PortNumber</span>
</span></code></pre></div></li> </ul> </li> </ul> <h3 id=stage-4>Stage 4 - Implement Basic Firewall Rules (ACLs) on C1111<a class=headerlink href=#stage-4 title="Permanent link">&para;</a></h3> <ul> <li><strong>Goal:</strong> Control traffic flow:<ul> <li>From your Home Network to the Homelab Network (allow specific, deny rest).</li> <li>From your Homelab Network to the Home Network (likely deny most, allow specific if needed).</li> <li>From the Internet inbound to your router's WAN interface (default deny unsolicited, allow established).</li> </ul> </li> <li><strong>ACL Logic:</strong> ACLs are processed top-down. The first matching rule is applied. There's an implicit <code>deny any any</code> at the end of every ACL, so if no permit rule matches, traffic is dropped.<ul> <li>Each rule is created with explicit priority number for easier updates and management</li> <li>Rules are grouped by category in increments of 100, so new rules can be inserted easier with minimal to none renumbering of existing rules.</li> </ul> </li> </ul> <h4 id=c1111-configuration-steps_3>C1111 Configuration Steps<a class=headerlink href=#c1111-configuration-steps_3 title="Permanent link">&para;</a></h4> <div class="language-text highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a>conf t
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a>
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>object-group network K8S_LB_POOL_NETS
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a> 10.10.10.40 255.255.255.248  ! /29
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a> 10.10.10.48 255.255.255.240  ! /28
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a> 10.10.10.64 255.255.255.252  ! /30
</span><span id=__span-32-7><a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a> 10.10.10.68 255.255.255.254  ! /31
</span><span id=__span-32-8><a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a>exit
</span><span id=__span-32-9><a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a>
</span><span id=__span-32-10><a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a>! --- Define ACL for traffic FROM Home Network ---
</span><span id=__span-32-11><a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a>ip access-list extended ACL_FROM_HOME_NETWORK
</span><span id=__span-32-12><a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a> 10 remark === ACL: FROM HOME NETWORK (192.168.1.x) ===
</span><span id=__span-32-13><a id=__codelineno-32-13 name=__codelineno-32-13 href=#__codelineno-32-13></a> 10 remark ============================================
</span><span id=__span-32-14><a id=__codelineno-32-14 name=__codelineno-32-14 href=#__codelineno-32-14></a>
</span><span id=__span-32-15><a id=__codelineno-32-15 name=__codelineno-32-15 href=#__codelineno-32-15></a> 20 remark --- PERMIT DHCP TRAFFIC (MUST BE EARLY) ---
</span><span id=__span-32-16><a id=__codelineno-32-16 name=__codelineno-32-16 href=#__codelineno-32-16></a> 21 remark Permit -&gt; DHCP Discover/Request from clients to broadcast (0.0.0.0 or 192.168.1.x to 255.255.255.255)
</span><span id=__span-32-17><a id=__codelineno-32-17 name=__codelineno-32-17 href=#__codelineno-32-17></a> 21 permit udp any host 255.255.255.255 eq bootps
</span><span id=__span-32-18><a id=__codelineno-32-18 name=__codelineno-32-18 href=#__codelineno-32-18></a> 22 remark Permit -&gt; DHCP Discover/Request from clients to gateway (0.0.0.0 or 192.168.1.x to 192.168.1.1)
</span><span id=__span-32-19><a id=__codelineno-32-19 name=__codelineno-32-19 href=#__codelineno-32-19></a> 22 permit udp any host 192.168.1.1 eq bootps
</span><span id=__span-32-20><a id=__codelineno-32-20 name=__codelineno-32-20 href=#__codelineno-32-20></a> 23 remark Permit -&gt; DHCP Offer/ACK from server to broadcast/client (192.168.1.1 to 255.255.255.255 or 192.168.1.x)
</span><span id=__span-32-21><a id=__codelineno-32-21 name=__codelineno-32-21 href=#__codelineno-32-21></a> 23 permit udp host 192.168.1.1 eq bootps any eq bootpc
</span><span id=__span-32-22><a id=__codelineno-32-22 name=__codelineno-32-22 href=#__codelineno-32-22></a> 99 remark --- END ---
</span><span id=__span-32-23><a id=__codelineno-32-23 name=__codelineno-32-23 href=#__codelineno-32-23></a>
</span><span id=__span-32-24><a id=__codelineno-32-24 name=__codelineno-32-24 href=#__codelineno-32-24></a> 100 remark --- Specific PERMITS from Home to Management IPs ---
</span><span id=__span-32-25><a id=__codelineno-32-25 name=__codelineno-32-25 href=#__codelineno-32-25></a> 101 remark -&gt; Permit SSH from Home to Muspell Router&#39;s Homelab SVI (10.10.10.1)
</span><span id=__span-32-26><a id=__codelineno-32-26 name=__codelineno-32-26 href=#__codelineno-32-26></a> 101 permit tcp 192.168.1.0 0.0.0.255 host 10.10.10.1 eq 22
</span><span id=__span-32-27><a id=__codelineno-32-27 name=__codelineno-32-27 href=#__codelineno-32-27></a> 102 remark -&gt; Permit SSH from Home to Router&#39;s Home SVI (192.168.1.1)
</span><span id=__span-32-28><a id=__codelineno-32-28 name=__codelineno-32-28 href=#__codelineno-32-28></a> 102 permit tcp 192.168.1.0 0.0.0.255 host 192.168.1.1 eq 22
</span><span id=__span-32-29><a id=__codelineno-32-29 name=__codelineno-32-29 href=#__codelineno-32-29></a> 103 remark -&gt; Permit SSH from Home to Bifrost Switch&#39;s Homelab SVI (10.10.10.2)
</span><span id=__span-32-30><a id=__codelineno-32-30 name=__codelineno-32-30 href=#__codelineno-32-30></a> 103 permit tcp 192.168.1.0 0.0.0.255 host 10.10.10.2 eq 22
</span><span id=__span-32-31><a id=__codelineno-32-31 name=__codelineno-32-31 href=#__codelineno-32-31></a> 199 remark --- END ---
</span><span id=__span-32-32><a id=__codelineno-32-32 name=__codelineno-32-32 href=#__codelineno-32-32></a>
</span><span id=__span-32-33><a id=__codelineno-32-33 name=__codelineno-32-33 href=#__codelineno-32-33></a> 200 remark --- Specific PERMITS from Home to Homelab K8s Nodes ---
</span><span id=__span-32-34><a id=__codelineno-32-34 name=__codelineno-32-34 href=#__codelineno-32-34></a> 201 remark -&gt; Permit SSH from Home to k8s odin control
</span><span id=__span-32-35><a id=__codelineno-32-35 name=__codelineno-32-35 href=#__codelineno-32-35></a> 201 permit tcp 192.168.1.0 0.0.0.255 host 10.10.10.10 eq 22
</span><span id=__span-32-36><a id=__codelineno-32-36 name=__codelineno-32-36 href=#__codelineno-32-36></a> 202 remark -&gt; Permit SSH from Home to k8s thor control
</span><span id=__span-32-37><a id=__codelineno-32-37 name=__codelineno-32-37 href=#__codelineno-32-37></a> 202 permit tcp 192.168.1.0 0.0.0.255 host 10.10.10.11 eq 22
</span><span id=__span-32-38><a id=__codelineno-32-38 name=__codelineno-32-38 href=#__codelineno-32-38></a> 203 remark -&gt; Permit SSH from Home to k8s heimdall control
</span><span id=__span-32-39><a id=__codelineno-32-39 name=__codelineno-32-39 href=#__codelineno-32-39></a> 203 permit tcp 192.168.1.0 0.0.0.255 host 10.10.10.12 eq 22
</span><span id=__span-32-40><a id=__codelineno-32-40 name=__codelineno-32-40 href=#__codelineno-32-40></a> 204 remark -&gt; Permit SSH from Home to k8s mjolnir worker
</span><span id=__span-32-41><a id=__codelineno-32-41 name=__codelineno-32-41 href=#__codelineno-32-41></a> 204 permit tcp 192.168.1.0 0.0.0.255 host 10.10.10.20 eq 22
</span><span id=__span-32-42><a id=__codelineno-32-42 name=__codelineno-32-42 href=#__codelineno-32-42></a> 205 remark -&gt; Permit SSH from Home to k8s gungnir worker
</span><span id=__span-32-43><a id=__codelineno-32-43 name=__codelineno-32-43 href=#__codelineno-32-43></a> 205 permit tcp 192.168.1.0 0.0.0.255 host 10.10.10.21 eq 22
</span><span id=__span-32-44><a id=__codelineno-32-44 name=__codelineno-32-44 href=#__codelineno-32-44></a> 206 remark -&gt; Permit SSH from Home to k8s draupnir worker
</span><span id=__span-32-45><a id=__codelineno-32-45 name=__codelineno-32-45 href=#__codelineno-32-45></a> 206 permit tcp 192.168.1.0 0.0.0.255 host 10.10.10.22 eq 22
</span><span id=__span-32-46><a id=__codelineno-32-46 name=__codelineno-32-46 href=#__codelineno-32-46></a> 207 remark -&gt; Permit SSH from Home to k8s megingjord worker
</span><span id=__span-32-47><a id=__codelineno-32-47 name=__codelineno-32-47 href=#__codelineno-32-47></a> 207 permit tcp 192.168.1.0 0.0.0.255 host 10.10.10.23 eq 22
</span><span id=__span-32-48><a id=__codelineno-32-48 name=__codelineno-32-48 href=#__codelineno-32-48></a> 299 remark --- END ---
</span><span id=__span-32-49><a id=__codelineno-32-49 name=__codelineno-32-49 href=#__codelineno-32-49></a>
</span><span id=__span-32-50><a id=__codelineno-32-50 name=__codelineno-32-50 href=#__codelineno-32-50></a> 300 remark --- Specific PERMITS from Home to Homelab NAS ---
</span><span id=__span-32-51><a id=__codelineno-32-51 name=__codelineno-32-51 href=#__codelineno-32-51></a> 301 remark -&gt; Permit SSH from Home to yggdrasil nas
</span><span id=__span-32-52><a id=__codelineno-32-52 name=__codelineno-32-52 href=#__codelineno-32-52></a> 301 permit tcp 192.168.1.0 0.0.0.255 host 10.10.10.30 eq 22
</span><span id=__span-32-53><a id=__codelineno-32-53 name=__codelineno-32-53 href=#__codelineno-32-53></a> 302 remark -&gt; Permit SMB/CIFS from Home to yggdrasil nas
</span><span id=__span-32-54><a id=__codelineno-32-54 name=__codelineno-32-54 href=#__codelineno-32-54></a> 302 permit tcp 192.168.1.0 0.0.0.255 host 10.10.10.30 eq 445
</span><span id=__span-32-55><a id=__codelineno-32-55 name=__codelineno-32-55 href=#__codelineno-32-55></a> 399 remark --- END ---
</span><span id=__span-32-56><a id=__codelineno-32-56 name=__codelineno-32-56 href=#__codelineno-32-56></a>
</span><span id=__span-32-57><a id=__codelineno-32-57 name=__codelineno-32-57 href=#__codelineno-32-57></a> 400 remark --- Specific PERMITS from Home to Homelab K8s ports ---
</span><span id=__span-32-58><a id=__codelineno-32-58 name=__codelineno-32-58 href=#__codelineno-32-58></a> 401 remark -&gt; Permit HTTP from Home to k8s ingress
</span><span id=__span-32-59><a id=__codelineno-32-59 name=__codelineno-32-59 href=#__codelineno-32-59></a> 401 remark -&gt; Permit HTTP from Home to K8s LoadBalancer Pool
</span><span id=__span-32-60><a id=__codelineno-32-60 name=__codelineno-32-60 href=#__codelineno-32-60></a> 401 permit tcp 192.168.1.0 0.0.0.255 object-group K8S_LB_POOL_NETS eq 80
</span><span id=__span-32-61><a id=__codelineno-32-61 name=__codelineno-32-61 href=#__codelineno-32-61></a> 402 remark -&gt; Permit HTTPS from Home to K8s LoadBalancer Pool
</span><span id=__span-32-62><a id=__codelineno-32-62 name=__codelineno-32-62 href=#__codelineno-32-62></a> 402 permit tcp 192.168.1.0 0.0.0.255 object-group K8S_LB_POOL_NETS eq 443
</span><span id=__span-32-63><a id=__codelineno-32-63 name=__codelineno-32-63 href=#__codelineno-32-63></a> 403 remark -&gt; Permit Home to k8s control plane endpoint
</span><span id=__span-32-64><a id=__codelineno-32-64 name=__codelineno-32-64 href=#__codelineno-32-64></a> 403 permit tcp 192.168.1.0 0.0.0.255 host 10.10.10.100 eq 6443
</span><span id=__span-32-65><a id=__codelineno-32-65 name=__codelineno-32-65 href=#__codelineno-32-65></a> 404 remark -&gt; Permit SSH from Home to K8s LoadBalancer Pool
</span><span id=__span-32-66><a id=__codelineno-32-66 name=__codelineno-32-66 href=#__codelineno-32-66></a> 404 permit tcp 192.168.1.0 0.0.0.255 object-group K8S_LB_POOL_NETS eq 22
</span><span id=__span-32-67><a id=__codelineno-32-67 name=__codelineno-32-67 href=#__codelineno-32-67></a> 499 remark --- END ---
</span><span id=__span-32-68><a id=__codelineno-32-68 name=__codelineno-32-68 href=#__codelineno-32-68></a>
</span><span id=__span-32-69><a id=__codelineno-32-69 name=__codelineno-32-69 href=#__codelineno-32-69></a> 500 remark --- ICMP Rules for Home Network ---
</span><span id=__span-32-70><a id=__codelineno-32-70 name=__codelineno-32-70 href=#__codelineno-32-70></a> 501 remark -&gt; Permit Home to ping Homelab
</span><span id=__span-32-71><a id=__codelineno-32-71 name=__codelineno-32-71 href=#__codelineno-32-71></a> 501 permit icmp 192.168.1.0 0.0.0.255 10.10.10.0 0.0.0.255 echo
</span><span id=__span-32-72><a id=__codelineno-32-72 name=__codelineno-32-72 href=#__codelineno-32-72></a> 502 remark -&gt; Permit Home to receive ping replies from Homelab
</span><span id=__span-32-73><a id=__codelineno-32-73 name=__codelineno-32-73 href=#__codelineno-32-73></a> 502 permit icmp 10.10.10.0 0.0.0.255 192.168.1.0 0.0.0.255 echo-reply
</span><span id=__span-32-74><a id=__codelineno-32-74 name=__codelineno-32-74 href=#__codelineno-32-74></a> 503 remark -&gt; Permit Ping from Home to K8s LoadBalancer Pool
</span><span id=__span-32-75><a id=__codelineno-32-75 name=__codelineno-32-75 href=#__codelineno-32-75></a> 503 permit icmp 192.168.1.0 0.0.0.255 object-group K8S_LB_POOL_NETS echo
</span><span id=__span-32-76><a id=__codelineno-32-76 name=__codelineno-32-76 href=#__codelineno-32-76></a> 599 remark --- END ---
</span><span id=__span-32-77><a id=__codelineno-32-77 name=__codelineno-32-77 href=#__codelineno-32-77></a>
</span><span id=__span-32-78><a id=__codelineno-32-78 name=__codelineno-32-78 href=#__codelineno-32-78></a> 998 remark -&gt; Deny any other Home traffic specifically TO Homelab network and log
</span><span id=__span-32-79><a id=__codelineno-32-79 name=__codelineno-32-79 href=#__codelineno-32-79></a> 998 deny ip 192.168.1.0 0.0.0.255 10.10.10.0 0.0.0.255 log
</span><span id=__span-32-80><a id=__codelineno-32-80 name=__codelineno-32-80 href=#__codelineno-32-80></a>
</span><span id=__span-32-81><a id=__codelineno-32-81 name=__codelineno-32-81 href=#__codelineno-32-81></a> 999 remark -&gt; Permit Home Network to ALL other destinations (e.g., Internet)
</span><span id=__span-32-82><a id=__codelineno-32-82 name=__codelineno-32-82 href=#__codelineno-32-82></a> 999 permit ip 192.168.1.0 0.0.0.255 any
</span><span id=__span-32-83><a id=__codelineno-32-83 name=__codelineno-32-83 href=#__codelineno-32-83></a>exit
</span><span id=__span-32-84><a id=__codelineno-32-84 name=__codelineno-32-84 href=#__codelineno-32-84></a>
</span><span id=__span-32-85><a id=__codelineno-32-85 name=__codelineno-32-85 href=#__codelineno-32-85></a>! --- Define ACL for traffic FROM Homelab Network ---
</span><span id=__span-32-86><a id=__codelineno-32-86 name=__codelineno-32-86 href=#__codelineno-32-86></a>ip access-list extended ACL_FROM_HOMELAB_NETWORK
</span><span id=__span-32-87><a id=__codelineno-32-87 name=__codelineno-32-87 href=#__codelineno-32-87></a> 10 remark === ACL: FROM HOMELAB NETWORK (10.10.10.x) ===
</span><span id=__span-32-88><a id=__codelineno-32-88 name=__codelineno-32-88 href=#__codelineno-32-88></a> 10 remark ==============================================
</span><span id=__span-32-89><a id=__codelineno-32-89 name=__codelineno-32-89 href=#__codelineno-32-89></a>
</span><span id=__span-32-90><a id=__codelineno-32-90 name=__codelineno-32-90 href=#__codelineno-32-90></a> 20 remark --- PERMIT DHCP TRAFFIC (MUST BE EARLY) ---
</span><span id=__span-32-91><a id=__codelineno-32-91 name=__codelineno-32-91 href=#__codelineno-32-91></a> 21 remark Permit -&gt; DHCP Discover/Request from clients to broadcast (0.0.0.0 or 10.10.10.x to 255.255.255.255)
</span><span id=__span-32-92><a id=__codelineno-32-92 name=__codelineno-32-92 href=#__codelineno-32-92></a> 21 permit udp any host 255.255.255.255 eq bootps
</span><span id=__span-32-93><a id=__codelineno-32-93 name=__codelineno-32-93 href=#__codelineno-32-93></a> 22 remark Permit -&gt; DHCP Discover/Request from clients to gateway (0.0.0.0 or 10.10.10.x to 10.10.10.1)
</span><span id=__span-32-94><a id=__codelineno-32-94 name=__codelineno-32-94 href=#__codelineno-32-94></a> 22 permit udp any host 10.10.10.1 eq bootps
</span><span id=__span-32-95><a id=__codelineno-32-95 name=__codelineno-32-95 href=#__codelineno-32-95></a> 23 remark Permit -&gt; DHCP Offer/ACK from server to broadcast/client (10.10.10.1 to 255.255.255.255 or 10.10.10.x)
</span><span id=__span-32-96><a id=__codelineno-32-96 name=__codelineno-32-96 href=#__codelineno-32-96></a> 23 permit udp host 10.10.10.1 eq bootps any eq bootpc
</span><span id=__span-32-97><a id=__codelineno-32-97 name=__codelineno-32-97 href=#__codelineno-32-97></a> 99 remark --- END ---
</span><span id=__span-32-98><a id=__codelineno-32-98 name=__codelineno-32-98 href=#__codelineno-32-98></a>
</span><span id=__span-32-99><a id=__codelineno-32-99 name=__codelineno-32-99 href=#__codelineno-32-99></a> 100 remark --- SSH Specific Permits ---
</span><span id=__span-32-100><a id=__codelineno-32-100 name=__codelineno-32-100 href=#__codelineno-32-100></a> ! Allow SSH RESPONSES from Router&#39;s Homelab SVI (10.10.10.1) to Home Network (needed for your management session)
</span><span id=__span-32-101><a id=__codelineno-32-101 name=__codelineno-32-101 href=#__codelineno-32-101></a> 101 remark -&gt; Permit SSH RESPONSES from Router&#39;s Homelab SVI (10.10.10.1) to Home Network
</span><span id=__span-32-102><a id=__codelineno-32-102 name=__codelineno-32-102 href=#__codelineno-32-102></a> 101 permit tcp host 10.10.10.1 192.168.1.0 0.0.0.255 established
</span><span id=__span-32-103><a id=__codelineno-32-103 name=__codelineno-32-103 href=#__codelineno-32-103></a> 102 remark -&gt; Permit SSH RESPONSES from Switch&#39;s Homelab SVI (10.10.10.2) to Home Network
</span><span id=__span-32-104><a id=__codelineno-32-104 name=__codelineno-32-104 href=#__codelineno-32-104></a> 102 permit tcp host 10.10.10.2 192.168.1.0 0.0.0.255 established
</span><span id=__span-32-105><a id=__codelineno-32-105 name=__codelineno-32-105 href=#__codelineno-32-105></a> ! (Optional: Add permits if Homelab needs to SSH to router&#39;s Homelab SVI - local management when e.g. laptop is physically connected to homelab network)
</span><span id=__span-32-106><a id=__codelineno-32-106 name=__codelineno-32-106 href=#__codelineno-32-106></a> 103 remark -&gt; Permit SSH from Homelab to router&#39;s Homelab SVI (local management)
</span><span id=__span-32-107><a id=__codelineno-32-107 name=__codelineno-32-107 href=#__codelineno-32-107></a> 103 permit tcp 10.10.10.0 0.0.0.255 host 10.10.10.1 eq 22
</span><span id=__span-32-108><a id=__codelineno-32-108 name=__codelineno-32-108 href=#__codelineno-32-108></a> 104 remark -&gt; Permit SSH from Homelab to switch&#39;s Homelab SVI (local management)
</span><span id=__span-32-109><a id=__codelineno-32-109 name=__codelineno-32-109 href=#__codelineno-32-109></a> 104 permit tcp 10.10.10.0 0.0.0.255 host 10.10.10.2 eq 22
</span><span id=__span-32-110><a id=__codelineno-32-110 name=__codelineno-32-110 href=#__codelineno-32-110></a> ! Allow SSH RESPONSES from k8s control to Home Network
</span><span id=__span-32-111><a id=__codelineno-32-111 name=__codelineno-32-111 href=#__codelineno-32-111></a> 110 remark -&gt; Permit SSH RESPONSES from odin (10.10.10.10) to Home Network
</span><span id=__span-32-112><a id=__codelineno-32-112 name=__codelineno-32-112 href=#__codelineno-32-112></a> 110 permit tcp host 10.10.10.10 192.168.1.0 0.0.0.255 established
</span><span id=__span-32-113><a id=__codelineno-32-113 name=__codelineno-32-113 href=#__codelineno-32-113></a> 111 remark -&gt; Permit SSH RESPONSES from odin (10.10.10.11) to Home Network
</span><span id=__span-32-114><a id=__codelineno-32-114 name=__codelineno-32-114 href=#__codelineno-32-114></a> 111 permit tcp host 10.10.10.11 192.168.1.0 0.0.0.255 established
</span><span id=__span-32-115><a id=__codelineno-32-115 name=__codelineno-32-115 href=#__codelineno-32-115></a> 112 remark -&gt; Permit SSH RESPONSES from heimdall (10.10.10.12) to Home Network
</span><span id=__span-32-116><a id=__codelineno-32-116 name=__codelineno-32-116 href=#__codelineno-32-116></a> 112 permit tcp host 10.10.10.12 192.168.1.0 0.0.0.255 established
</span><span id=__span-32-117><a id=__codelineno-32-117 name=__codelineno-32-117 href=#__codelineno-32-117></a> ! Allow SSH RESPONSES from k8s workers to Home Network
</span><span id=__span-32-118><a id=__codelineno-32-118 name=__codelineno-32-118 href=#__codelineno-32-118></a> 120 remark -&gt; Permit SSH RESPONSES from mjolnir (10.10.10.20) to Home Network
</span><span id=__span-32-119><a id=__codelineno-32-119 name=__codelineno-32-119 href=#__codelineno-32-119></a> 120 permit tcp host 10.10.10.20 192.168.1.0 0.0.0.255 established
</span><span id=__span-32-120><a id=__codelineno-32-120 name=__codelineno-32-120 href=#__codelineno-32-120></a> 121 remark -&gt; Permit SSH RESPONSES from gungnir (10.10.10.21) to Home Network
</span><span id=__span-32-121><a id=__codelineno-32-121 name=__codelineno-32-121 href=#__codelineno-32-121></a> 121 permit tcp host 10.10.10.21 192.168.1.0 0.0.0.255 established
</span><span id=__span-32-122><a id=__codelineno-32-122 name=__codelineno-32-122 href=#__codelineno-32-122></a> 122 remark -&gt; Permit SSH RESPONSES from draupnir (10.10.10.22) to Home Network
</span><span id=__span-32-123><a id=__codelineno-32-123 name=__codelineno-32-123 href=#__codelineno-32-123></a> 122 permit tcp host 10.10.10.22 192.168.1.0 0.0.0.255 established
</span><span id=__span-32-124><a id=__codelineno-32-124 name=__codelineno-32-124 href=#__codelineno-32-124></a> 123 remark -&gt; Permit SSH RESPONSES from megingjord (10.10.10.23) to Home Network
</span><span id=__span-32-125><a id=__codelineno-32-125 name=__codelineno-32-125 href=#__codelineno-32-125></a> 123 permit tcp host 10.10.10.23 192.168.1.0 0.0.0.255 established
</span><span id=__span-32-126><a id=__codelineno-32-126 name=__codelineno-32-126 href=#__codelineno-32-126></a> ! Allow SSH RESPONSES from k8s storage to Home Network
</span><span id=__span-32-127><a id=__codelineno-32-127 name=__codelineno-32-127 href=#__codelineno-32-127></a> 130 remark -&gt; Permit SSH RESPONSES from yggdrasil (10.10.10.30) to Home Network
</span><span id=__span-32-128><a id=__codelineno-32-128 name=__codelineno-32-128 href=#__codelineno-32-128></a> 130 permit tcp host 10.10.10.30 192.168.1.0 0.0.0.255 established
</span><span id=__span-32-129><a id=__codelineno-32-129 name=__codelineno-32-129 href=#__codelineno-32-129></a> 199 remark --- END ---
</span><span id=__span-32-130><a id=__codelineno-32-130 name=__codelineno-32-130 href=#__codelineno-32-130></a>
</span><span id=__span-32-131><a id=__codelineno-32-131 name=__codelineno-32-131 href=#__codelineno-32-131></a> ! (Optional: ICMP rules for Homelab, e.g., pinging Home or receiving replies)
</span><span id=__span-32-132><a id=__codelineno-32-132 name=__codelineno-32-132 href=#__codelineno-32-132></a> 200 remark --- ICMP Rules for Homelab Network ---
</span><span id=__span-32-133><a id=__codelineno-32-133 name=__codelineno-32-133 href=#__codelineno-32-133></a> 201 remark -&gt; Permit Homelab to ping Home
</span><span id=__span-32-134><a id=__codelineno-32-134 name=__codelineno-32-134 href=#__codelineno-32-134></a> 201 permit icmp 10.10.10.0 0.0.0.255 192.168.1.0 0.0.0.255 echo
</span><span id=__span-32-135><a id=__codelineno-32-135 name=__codelineno-32-135 href=#__codelineno-32-135></a> 202 remark -&gt; Permit Homelab to receive ping replies from Home
</span><span id=__span-32-136><a id=__codelineno-32-136 name=__codelineno-32-136 href=#__codelineno-32-136></a> 202 permit icmp 192.168.1.0 0.0.0.255 10.10.10.0 0.0.0.255 echo-reply
</span><span id=__span-32-137><a id=__codelineno-32-137 name=__codelineno-32-137 href=#__codelineno-32-137></a> 203 remark -&gt; Permit Homelab to send ping replies TO Home (in response to pings FROM Home)
</span><span id=__span-32-138><a id=__codelineno-32-138 name=__codelineno-32-138 href=#__codelineno-32-138></a> 203 permit icmp 10.10.10.0 0.0.0.255 192.168.1.0 0.0.0.255 echo-reply
</span><span id=__span-32-139><a id=__codelineno-32-139 name=__codelineno-32-139 href=#__codelineno-32-139></a> 299 remark --- END ---
</span><span id=__span-32-140><a id=__codelineno-32-140 name=__codelineno-32-140 href=#__codelineno-32-140></a>
</span><span id=__span-32-141><a id=__codelineno-32-141 name=__codelineno-32-141 href=#__codelineno-32-141></a> 400 remark --- K8s specific permits ---
</span><span id=__span-32-142><a id=__codelineno-32-142 name=__codelineno-32-142 href=#__codelineno-32-142></a> 401 remark -&gt; Permit ESTABLISHED TCP from K8s LoadBalancer Pool TO Home Network
</span><span id=__span-32-143><a id=__codelineno-32-143 name=__codelineno-32-143 href=#__codelineno-32-143></a> 401 permit tcp object-group K8S_LB_POOL_NETS 192.168.1.0 0.0.0.255 established
</span><span id=__span-32-144><a id=__codelineno-32-144 name=__codelineno-32-144 href=#__codelineno-32-144></a> 403 remark -&gt; Permit k8s control plane responses to Home Network
</span><span id=__span-32-145><a id=__codelineno-32-145 name=__codelineno-32-145 href=#__codelineno-32-145></a> 403 permit tcp host 10.10.10.100 192.168.1.0 0.0.0.255 established
</span><span id=__span-32-146><a id=__codelineno-32-146 name=__codelineno-32-146 href=#__codelineno-32-146></a> 499 remark --- END ---
</span><span id=__span-32-147><a id=__codelineno-32-147 name=__codelineno-32-147 href=#__codelineno-32-147></a>
</span><span id=__span-32-148><a id=__codelineno-32-148 name=__codelineno-32-148 href=#__codelineno-32-148></a> 998 remark -&gt; Deny and log other Homelab Network traffic specifically TO Home Network
</span><span id=__span-32-149><a id=__codelineno-32-149 name=__codelineno-32-149 href=#__codelineno-32-149></a> 998 deny ip 10.10.10.0 0.0.0.255 192.168.1.0 0.0.0.255 log
</span><span id=__span-32-150><a id=__codelineno-32-150 name=__codelineno-32-150 href=#__codelineno-32-150></a>
</span><span id=__span-32-151><a id=__codelineno-32-151 name=__codelineno-32-151 href=#__codelineno-32-151></a> 999 remark -&gt; Permit Homelab Network to ALL other destinations (e.g., Internet)
</span><span id=__span-32-152><a id=__codelineno-32-152 name=__codelineno-32-152 href=#__codelineno-32-152></a> 999 permit ip 10.10.10.0 0.0.0.255 any
</span><span id=__span-32-153><a id=__codelineno-32-153 name=__codelineno-32-153 href=#__codelineno-32-153></a>exit
</span><span id=__span-32-154><a id=__codelineno-32-154 name=__codelineno-32-154 href=#__codelineno-32-154></a>
</span><span id=__span-32-155><a id=__codelineno-32-155 name=__codelineno-32-155 href=#__codelineno-32-155></a>! --- Define ACL for traffic FROM Internet (WAN Inbound) ---
</span><span id=__span-32-156><a id=__codelineno-32-156 name=__codelineno-32-156 href=#__codelineno-32-156></a>ip access-list extended ACL_WAN_INBOUND
</span><span id=__span-32-157><a id=__codelineno-32-157 name=__codelineno-32-157 href=#__codelineno-32-157></a> 10 remark === ACL: FROM INTERNET (WAN Inbound) ===
</span><span id=__span-32-158><a id=__codelineno-32-158 name=__codelineno-32-158 href=#__codelineno-32-158></a> 10 remark ========================================
</span><span id=__span-32-159><a id=__codelineno-32-159 name=__codelineno-32-159 href=#__codelineno-32-159></a>
</span><span id=__span-32-160><a id=__codelineno-32-160 name=__codelineno-32-160 href=#__codelineno-32-160></a> 20 remark --- PERMIT DHCP TRAFFIC (MUST BE EARLY) ---
</span><span id=__span-32-161><a id=__codelineno-32-161 name=__codelineno-32-161 href=#__codelineno-32-161></a> 21 remark Permit -&gt; DHCP responses TO the router&#39;s WAN interface
</span><span id=__span-32-162><a id=__codelineno-32-162 name=__codelineno-32-162 href=#__codelineno-32-162></a> 21 remark (Source port is 67 - DHCP/BOOTP Server, Destination port is 68 - DHCP/BOOTP Client)
</span><span id=__span-32-163><a id=__codelineno-32-163 name=__codelineno-32-163 href=#__codelineno-32-163></a> 21 permit udp any eq bootps any eq bootpc
</span><span id=__span-32-164><a id=__codelineno-32-164 name=__codelineno-32-164 href=#__codelineno-32-164></a> 30 remark --- PERMIT NTP TRAFFIC ---
</span><span id=__span-32-165><a id=__codelineno-32-165 name=__codelineno-32-165 href=#__codelineno-32-165></a> 31 remark -&gt; Permit NTP UDP responses from any NTP server (source port 123) to any port on router
</span><span id=__span-32-166><a id=__codelineno-32-166 name=__codelineno-32-166 href=#__codelineno-32-166></a> ! it seems like C1111 uses a dynamic port to receive NTP replies, and receiving ports on router seem to be below 1023
</span><span id=__span-32-167><a id=__codelineno-32-167 name=__codelineno-32-167 href=#__codelineno-32-167></a> ! 31 permit udp any eq ntp any gt 1023
</span><span id=__span-32-168><a id=__codelineno-32-168 name=__codelineno-32-168 href=#__codelineno-32-168></a> 31 permit udp any eq ntp any
</span><span id=__span-32-169><a id=__codelineno-32-169 name=__codelineno-32-169 href=#__codelineno-32-169></a> 99 remark --- END ---
</span><span id=__span-32-170><a id=__codelineno-32-170 name=__codelineno-32-170 href=#__codelineno-32-170></a>
</span><span id=__span-32-171><a id=__codelineno-32-171 name=__codelineno-32-171 href=#__codelineno-32-171></a> 100 remark --- Other WAN rules ---
</span><span id=__span-32-172><a id=__codelineno-32-172 name=__codelineno-32-172 href=#__codelineno-32-172></a> 101 remark -&gt; Permit established TCP sessions
</span><span id=__span-32-173><a id=__codelineno-32-173 name=__codelineno-32-173 href=#__codelineno-32-173></a> 101 permit tcp any any established
</span><span id=__span-32-174><a id=__codelineno-32-174 name=__codelineno-32-174 href=#__codelineno-32-174></a> 102 remark -&gt; Permit DNS UDP responses from any DNS server (source port 53)
</span><span id=__span-32-175><a id=__codelineno-32-175 name=__codelineno-32-175 href=#__codelineno-32-175></a> 102 permit udp any eq 53 any gt 1023
</span><span id=__span-32-176><a id=__codelineno-32-176 name=__codelineno-32-176 href=#__codelineno-32-176></a> 103 remark -&gt; Permit Ping replies to router&#39;s WAN IP
</span><span id=__span-32-177><a id=__codelineno-32-177 name=__codelineno-32-177 href=#__codelineno-32-177></a> 103 permit icmp any any echo-reply
</span><span id=__span-32-178><a id=__codelineno-32-178 name=__codelineno-32-178 href=#__codelineno-32-178></a> 104 remark -&gt; Permit ICMP Time Exceeded (for traceroute)
</span><span id=__span-32-179><a id=__codelineno-32-179 name=__codelineno-32-179 href=#__codelineno-32-179></a> 104 permit icmp any any time-exceeded
</span><span id=__span-32-180><a id=__codelineno-32-180 name=__codelineno-32-180 href=#__codelineno-32-180></a> 105 remark -&gt; Permit ICMP Unreachable (for Path MTU discovery etc.)
</span><span id=__span-32-181><a id=__codelineno-32-181 name=__codelineno-32-181 href=#__codelineno-32-181></a> 105 permit icmp any any unreachable
</span><span id=__span-32-182><a id=__codelineno-32-182 name=__codelineno-32-182 href=#__codelineno-32-182></a> 199 remark --- END ---
</span><span id=__span-32-183><a id=__codelineno-32-183 name=__codelineno-32-183 href=#__codelineno-32-183></a>
</span><span id=__span-32-184><a id=__codelineno-32-184 name=__codelineno-32-184 href=#__codelineno-32-184></a> 998 remark -&gt; Deny and Log all other unsolicited Internet traffic
</span><span id=__span-32-185><a id=__codelineno-32-185 name=__codelineno-32-185 href=#__codelineno-32-185></a> 998 deny ip any any log
</span><span id=__span-32-186><a id=__codelineno-32-186 name=__codelineno-32-186 href=#__codelineno-32-186></a>exit
</span><span id=__span-32-187><a id=__codelineno-32-187 name=__codelineno-32-187 href=#__codelineno-32-187></a>
</span><span id=__span-32-188><a id=__codelineno-32-188 name=__codelineno-32-188 href=#__codelineno-32-188></a>! --- Apply ACLs to Interfaces ---
</span><span id=__span-32-189><a id=__codelineno-32-189 name=__codelineno-32-189 href=#__codelineno-32-189></a>interface Vlan2
</span><span id=__span-32-190><a id=__codelineno-32-190 name=__codelineno-32-190 href=#__codelineno-32-190></a> ip access-group ACL_FROM_HOME_NETWORK in
</span><span id=__span-32-191><a id=__codelineno-32-191 name=__codelineno-32-191 href=#__codelineno-32-191></a>exit
</span><span id=__span-32-192><a id=__codelineno-32-192 name=__codelineno-32-192 href=#__codelineno-32-192></a>
</span><span id=__span-32-193><a id=__codelineno-32-193 name=__codelineno-32-193 href=#__codelineno-32-193></a>interface Vlan10
</span><span id=__span-32-194><a id=__codelineno-32-194 name=__codelineno-32-194 href=#__codelineno-32-194></a> ip access-group ACL_FROM_HOMELAB_NETWORK in
</span><span id=__span-32-195><a id=__codelineno-32-195 name=__codelineno-32-195 href=#__codelineno-32-195></a>exit
</span><span id=__span-32-196><a id=__codelineno-32-196 name=__codelineno-32-196 href=#__codelineno-32-196></a>
</span><span id=__span-32-197><a id=__codelineno-32-197 name=__codelineno-32-197 href=#__codelineno-32-197></a>interface GigabitEthernet0/0/0
</span><span id=__span-32-198><a id=__codelineno-32-198 name=__codelineno-32-198 href=#__codelineno-32-198></a> ip access-group ACL_WAN_INBOUND in
</span><span id=__span-32-199><a id=__codelineno-32-199 name=__codelineno-32-199 href=#__codelineno-32-199></a>exit
</span><span id=__span-32-200><a id=__codelineno-32-200 name=__codelineno-32-200 href=#__codelineno-32-200></a>
</span><span id=__span-32-201><a id=__codelineno-32-201 name=__codelineno-32-201 href=#__codelineno-32-201></a>end
</span><span id=__span-32-202><a id=__codelineno-32-202 name=__codelineno-32-202 href=#__codelineno-32-202></a>! wr mem or copy run start
</span></code></pre></div> <p><strong>Important Considerations for ACLs:</strong></p> <ul> <li><strong>Order Matters:</strong> Rules are processed from top to bottom. The first match wins. Place more specific rules before more general rules.</li> <li><strong>Implicit Deny:</strong> There's an invisible <code>deny ip any any</code> at the end of every ACL. If you don't explicitly permit something, it will be denied. The explicit <code>deny ip ... log</code> rules above are for logging purposes.</li> <li><strong><code>log</code> Keyword:</strong> Adding <code>log</code> to a rule will generate a syslog message when that rule is hit. This is very useful for troubleshooting and seeing what traffic is being permitted or denied. However, it can generate a lot of logs, especially on deny rules, so use it judiciously or be prepared to filter logs.</li> <li><strong>Source/Destination:</strong><ul> <li>When applying an ACL <strong>inbound</strong> (<code>in</code>) on an interface:<ul> <li>The "source" in the ACL rule refers to where the traffic is coming <em>from</em> before it hits that interface.</li> <li>The "destination" refers to where it's going <em>after</em> it passes through that interface.</li> </ul> </li> </ul> </li> <li><strong>Refinement:</strong> Start with these basic ACLs. As you deploy services, you might need to refine them. For example, if a Homelab service needs to initiate a connection to a specific cloud service on a non-standard port, you might need to add an outbound ACL or adjust NAT policies (though typically NAT allows all outbound from trusted internal networks).</li> <li><strong>Stateful Inspection:</strong> The <code>permit tcp any any established</code> rule relies on the router's ability to track TCP connections. This is a basic form of stateful inspection. For more advanced stateful firewalling, Cisco routers use Zone-Based Firewall (ZBFW), which is more complex to set up than traditional ACLs. For a homelab, these ACLs are a good starting point.</li> </ul> <h4 id=verification-steps_3>Verification Steps<a class=headerlink href=#verification-steps_3 title="Permanent link">&para;</a></h4> <ol> <li><strong>From a Home Network device (e.g., laptop on <code>192.168.1.x</code>):</strong><ul> <li><strong>Test Permitted Traffic:</strong><ul> <li>SSH to K8s Control 1 (<code>10.10.10.10</code>). <strong>Should SUCCEED.</strong></li> <li>Access NAS 1 (<code>10.10.10.30</code>) on permitted ports (e.g., SMB, SSH). <strong>Should SUCCEED.</strong></li> <li>Ping any device in the Homelab Network (e.g., <code>ping 10.10.10.20</code> - K8s Worker 1). <strong>Should SUCCEED</strong> (due to <code>permit icmp ... echo</code>).</li> </ul> </li> <li><strong>Test Denied Traffic:</strong><ul> <li>Try to SSH to a K8s Worker node (e.g., <code>10.10.10.20</code>, assuming no explicit permit rule for it). <strong>Should FAIL/TIMEOUT.</strong></li> <li>Try to access NAS 1 on a non-permitted port. <strong>Should FAIL/TIMEOUT.</strong></li> </ul> </li> </ul> </li> <li><strong>From a Homelab Network device (e.g., K8s node <code>10.10.10.10</code>):</strong><ul> <li><strong>Test Denied Traffic (to Home Network):</strong><ul> <li>Try to ping a device on your Home Network (e.g., <code>ping 192.168.1.100</code> - your laptop). <strong>Should FAIL/TIMEOUT</strong> (unless you added a specific permit rule in <code>ACL_HOMELAB_TO_HOME</code>).</li> </ul> </li> <li><strong>Test Internet Access:</strong><ul> <li><code>ping 1.1.1.1</code>. <strong>Should SUCCEED</strong> (outbound traffic is NATted and not blocked by these ACLs).</li> </ul> </li> </ul> </li> <li><strong>Check C1111 Logs for Denials:</strong><ul> <li>On the C1111 router: <code>show logging</code></li> <li>Look for messages related to ACL denials (e.g., <code>%SEC-6-IPACCESSLOGP: list ACL_HOME_TO_HOMELAB denied tcp 192.168.1.X(port) -&gt; 10.10.10.Y(port)...</code>). This confirms your deny rules are working.</li> </ul> </li> <li><strong>Verify Internet Access for Both Networks:</strong> Ensure devices in both Home and Homelab networks can still access the internet as they could before applying ACLs (outbound traffic should generally be unaffected by these inbound ACLs).</li> <li><strong>Check NTP on C1111 and C3560</strong><ul> <li>Verify ntp status is synchronized, check ntp associations <div class="language-text highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a>sh clock
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a>14:31:38.416 UTC Wed Jun 11 2025
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a>sh ntp status
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>Clock is synchronized, stratum 3, reference is 82.148.168.42
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a>nominal freq is 250.0000 Hz, actual freq is 249.9955 Hz, precision is 2**10
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a>ntp uptime is 132400 (1/100 of seconds), resolution is 4016
</span><span id=__span-34-5><a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a>reference time is EBF411C2.FB22D398 (14:31:30.981 UTC Wed Jun 11 2025)
</span><span id=__span-34-6><a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a>clock offset is 0.6257 msec, root delay is 10.39 msec
</span><span id=__span-34-7><a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a>root dispersion is 7941.97 msec, peer dispersion is 188.53 msec
</span><span id=__span-34-8><a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a>loopfilter state is &#39;CTRL&#39; (Normal Controlled Loop), drift is 0.000018037 s/s
</span><span id=__span-34-9><a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a>system poll interval is 64, last update was 13 sec ago.
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a>sh ntp associations
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>  address         ref clock       st   when   poll reach  delay  offset   disp
</span><span id=__span-35-3><a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a>*~82.148.168.42   62.92.229.27     2     48     64     1  1.913   0.625 188.53
</span><span id=__span-35-4><a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a>+~192.36.143.130  .PPS.            1     59     64     1 13.999  -1.548 7937.9
</span><span id=__span-35-5><a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a>+~77.104.162.218  .PPS.            1     58     64     1 47.970  -3.393 7937.9
</span><span id=__span-35-6><a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a> * sys.peer, # selected, + candidate, - outlyer, x falseticker, ~ configured
</span></code></pre></div></li> </ul> </li> </ol> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>Some of the above tests can be run with this <a href=https://github.com/serpro69/ktchn8s/blob/master/tests/network_stage4.sh>script</a>.</p> </div> <h3 id=troubleshooting_1>Troubleshooting<a class=headerlink href=#troubleshooting_1 title="Permanent link">&para;</a></h3> <h4 id=ssh-error-no-matching-key-exchange-method-found>SSH error 'no matching key exchange method found'<a class=headerlink href=#ssh-error-no-matching-key-exchange-method-found title="Permanent link">&para;</a></h4> <p><strong>Problem:</strong></p> <p>After completing stage 2 setup on both C1111 and C3560, the following test was failing from a home network laptop:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a>ssh<span class=w> </span>user@10.10.10.2
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>Unable<span class=w> </span>to<span class=w> </span>negotiate<span class=w> </span>with<span class=w> </span><span class=m>10</span>.10.10.2<span class=w> </span>port<span class=w> </span><span class=m>22</span>:<span class=w> </span>no<span class=w> </span>matching<span class=w> </span>key<span class=w> </span>exchange<span class=w> </span>method<span class=w> </span>found.<span class=w> </span>Their<span class=w> </span>offer:<span class=w> </span>diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1
</span></code></pre></div> <p>The following is showed in c3560 console:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a>Jan  2 00:14:02.766: %SSH-3-NO_MATCH: No matching kex algorithm found: client curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp3841...
</span></code></pre></div> <p><strong>Explanation:</strong></p> <p>This is a classic compatibility issue between modern SSH clients and older network gear like the Cisco Catalyst 3560.</p> <p>The laptop's SSH client (which is likely using modern, more secure algorithms) is trying to negotiate a Key Exchange (KEX) method with the Cisco 3560. The 3560, running older software, only supports older, less secure KEX methods based on SHA-1 (like <code>diffie-hellman-group-exchange-sha1</code>, <code>diffie-hellman-group14-sha1</code>, <code>diffie-hellman-group1-sha1</code>). Modern SSH clients are configured by default to <em>reject</em> these older, potentially vulnerable methods. As a result, Neither side can find a mutually agreeable way to establish the secure channel, so the connection fails immediately.</p> <p><strong>The Solution:</strong></p> <p>The most practical way to fix this is to configure the SSH client on the laptop to temporarily accept one of the older KEX algorithms that the Cisco 3560 <em>does</em> offer.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Accepting older, SHA-1 based key exchange algorithms is inherently less secure than using modern ones. Use this as a workaround to connect to the device, ideally while planning for a potential IOS upgrade on the 3560 (if available and feasible) or limiting where you use this configuration.</p> </div> <ul> <li> <p>You can either specify the algorithm on the command line or configure your SSH client file.</p> <ul> <li> <p><strong>Using the Command Line (Temporary for Testing):</strong> This is the quickest way to test if this is the issue.</p> <ul> <li>Open your terminal or command prompt.</li> <li>Use the <code>-o KexAlgorithms</code> option to specify an accepted algorithm. Pick one from the C3560's offer list. <code>diffie-hellman-group14-sha1</code> is slightly preferred over <code>group1-sha1</code>.</li> <li>Enter the command: <div class="language-bash highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a>ssh<span class=w> </span>-o<span class=w> </span><span class=nv>KexAlgorithms</span><span class=o>=</span>diffie-hellman-group14-sha1<span class=w> </span>user@10.10.10.2
</span></code></pre></div></li> <li>If this connects, the KEX mismatch was indeed the problem.</li> </ul> </li> <li> <p><strong>Using the SSH Config File (More Permanent):</strong> This is better if you need to connect to this device frequently.</p> <ul> <li>Open a terminal or command prompt.</li> <li>Navigate to or create the <code>.ssh</code> directory in your user's home directory: <code>cd ~/.ssh</code> (If it doesn't exist, create it: <code>mkdir ~/.ssh</code>).</li> <li>Open the <code>config</code> file in a text editor (e.g., <code>nano ~/.ssh/config</code> or <code>notepad ~/.ssh/config</code> on Windows).</li> <li>Add the following block to the file. Replace <code>10.10.10.2</code> if you need to connect using a hostname instead. <div class="language-text highlight"><pre><span></span><code><span id=__span-39-1><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a>Host 10.10.10.2
</span><span id=__span-39-2><a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a>    KexAlgorithms +diffie-hellman-group14-sha1
</span></code></pre></div> <em>NB! The <code>+</code> sign is important!</em> It tells the client to <em>add</em> <code>diffie-hellman-group14-sha1</code> to its list of acceptable algorithms, rather than replacing the entire list. This is safer.</li> <li>Save the file.</li> <li>Now, try connecting using your regular command: <div class="language-bash highlight"><pre><span></span><code><span id=__span-40-1><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a>ssh<span class=w> </span>user@10.10.10.2
</span></code></pre></div></li> </ul> </li> <li> <p><strong>On the Cisco 3560 (Verification):</strong></p> <p>You don't usually need to configure the 3560 itself for this specific issue, as the problem is the client <em>rejecting</em> what the server offers. However, you can verify the available algorithms on the switch using:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-41-1><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a>show ip ssh server algorithms
</span></code></pre></div> <p>This command will list the supported KEX, encryption (cipher), and integrity (MAC) algorithms. Confirm that the list includes the <code>diffie-hellman-group</code> options.</p> </li> </ul> </li> </ul> <h4 id=ssh-error-no-matching-host-key-type-found>SSH error 'no matching host key type found'<a class=headerlink href=#ssh-error-no-matching-host-key-type-found title="Permanent link">&para;</a></h4> <p>After fixing the above error, I started getting another one when connecting to the same switch:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-42-1><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a>ssh<span class=w> </span>-o<span class=w> </span><span class=nv>KexAlgorithms</span><span class=o>=</span>diffie-hellman-group14-sha1<span class=w> </span>user@10.10.10.2
</span><span id=__span-42-2><a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a>Unable<span class=w> </span>to<span class=w> </span>negotiate<span class=w> </span>with<span class=w> </span><span class=m>10</span>.10.10.2<span class=w> </span>port<span class=w> </span><span class=m>22</span>:<span class=w> </span>no<span class=w> </span>matching<span class=w> </span>host<span class=w> </span>key<span class=w> </span><span class=nb>type</span><span class=w> </span>found.<span class=w> </span>Their<span class=w> </span>offer:<span class=w> </span>ssh-rsa
</span></code></pre></div> <p><strong>The Problem:</strong></p> <p>After key exchange, the server (the Cisco 3560) presents its <strong>host key</strong> to the client. This host key is used by the client to verify the server's identity (to prevent Man-in-the-Middle attacks). The error message tells you:</p> <ul> <li>The switch is offering a host key of type <code>ssh-rsa</code>.</li> <li>Your modern SSH client is <em>not</em> configured by default to accept <code>ssh-rsa</code> as a valid host key type.</li> </ul> <p>Why is this happening?</p> <ul> <li>More recent versions of OpenSSH clients (starting around version 8.2) have started disabling <code>ssh-rsa</code> by default when the server uses SHA-1 for signing, because SHA-1 is considered cryptographically weak. Older Cisco IOS versions often rely on SHA-1 for this.</li> <li>While the host key itself might be RSA, the <em>signature algorithm</em> used with it might be <code>rsa-sha2-256</code> or <code>rsa-sha2-512</code> on modern servers. Older servers only support the original <code>ssh-rsa</code> signature which implicitly uses SHA-1.</li> </ul> <p><strong>The Solution:</strong></p> <p>Similar to the KEX issue, you need to configure your SSH client to accept <code>ssh-rsa</code> as a valid host key type for this specific connection.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>As before, enabling older algorithms carries potential security risks. Only do this when connecting to trusted legacy devices and be aware that you are relying on less robust cryptography for server identity verification.</p> </div> <ul> <li> <p><strong>Using the Command Line (Temporary for Testing):</strong></p> <p>Add another <code>-o</code> option for <code>HostKeyAlgorithms</code>. You can chain multiple <code>-o</code> options.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-43-1><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a>ssh<span class=w> </span>-o<span class=w> </span><span class=nv>KexAlgorithms</span><span class=o>=</span>diffie-hellman-group14-sha1<span class=w> </span>-o<span class=w> </span><span class=nv>HostKeyAlgorithms</span><span class=o>=</span>ssh-rsa<span class=w> </span>user@10.10.10.2
</span></code></pre></div> <p><em>Note:</em> You might need to add the <code>+</code> prefix here as well, especially if you have a very recent SSH client, although sometimes <code>ssh-rsa</code> alone works for <code>HostKeyAlgorithms</code>:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-44-1><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=c1># If the above fails, try adding &#39;+&#39;</span>
</span><span id=__span-44-2><a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a>ssh<span class=w> </span>-o<span class=w> </span><span class=nv>KexAlgorithms</span><span class=o>=</span>diffie-hellman-group14-sha1<span class=w> </span>-o<span class=w> </span><span class=nv>HostKeyAlgorithms</span><span class=o>=</span>+ssh-rsa<span class=w> </span>user@10.10.10.2
</span></code></pre></div> </li> <li> <p><strong>Using the SSH Config File (More Permanent):</strong></p> <p>Edit your <code>~/.ssh/config</code> file again. Add a line for <code>HostKeyAlgorithms</code> under the <code>Host</code> block for 10.10.10.2. Use the <code>+</code> prefix to <em>add</em> <code>ssh-rsa</code> without removing other, more secure host key types you might need for other servers.</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-45-1><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a>Host 10.10.10.2
</span><span id=__span-45-2><a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a>    KexAlgorithms +diffie-hellman-group14-sha1
</span><span id=__span-45-3><a id=__codelineno-45-3 name=__codelineno-45-3 href=#__codelineno-45-3></a>    HostKeyAlgorithms +ssh-rsa  # Add this line
</span></code></pre></div> <p>Save the file. Now try connecting with the regular command:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-46-1><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a>ssh<span class=w> </span>user@10.10.10.2
</span></code></pre></div> </li> </ul> <h2 id=testing>Testing<a class=headerlink href=#testing title="Permanent link">&para;</a></h2> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>These tests are still in a work-in-progress state. Any contributions and improvements are very appreciated and most welcome!</p> </div> <p>Run verifications after the network has been configured with: </p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-47-1><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a>./tests/network_stage4.sh
</span></code></pre></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ class="md-footer__link md-footer__link--prev" aria-label="Previous: Production Deployment"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Production Deployment </div> </div> </a> <a href=../external/ class="md-footer__link md-footer__link--next" aria-label="Next: External Resources"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> External Resources </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2025 - present, serpro69 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../assets/javascripts/bundle.79ae519e.min.js></script> <script src=https://unpkg.com/mermaid@11.7.0/dist/mermaid.min.js></script> <script src=../../../assets/javascripts/mermaid-extra.js type=module></script> <script src=../../../assets/javascripts/panzoom.min.js></script> <script src=../../../assets/javascripts/zoompan.js></script> </body> </html>