---
# Default network CIDR for homelab
homelab_net_cidr: "10.10.10.0/24"

# Default NFS export options
default_nfs_options: "rw,sync,no_subtree_check,root_squash,insecure"

# Anonymous uid/gid for root_squash mapping (squashed root becomes this user).
# Set to match the uid/gid used by application pods (e.g. fsGroup) so that
# root-running containers and kubelet fsGroup chown operations work correctly.
nfs_anon_uid: 1000
nfs_anon_gid: 1000

# Firewall configuration
manage_firewall: true # Set to false to skip firewall configuration
# TODO: should use nftables on Debian (+ firewalld equivalent if we trully want to support redhat OSes)
install_ufw: true # Install UFW if not present (only when manage_firewall=true)
firewall_allowed_networks: # NB! The default will only allow connections (including SSH) from homelab network
  - "{{ homelab_net_cidr }}"
  - "192.168.1.100/32" # 'serenity' workstation with reserved static IP on vlan2 (home network)

# Network configuration (optional)
configure_network: true
storage_network:
  interface: "{{ network_interface | default('eth0') }}"
  address: "{{ ansible_host }}"
  netmask: "255.255.255.0"
  gateway: "10.10.10.1"
  dns_nameservers:
    - "10.10.10.1"
    - "1.1.1.1"

# Snapraid maintenance configuration
snapraid_maintenance:
  # Daily sync schedule (systemd timer format)
  sync_time: "02:00" # 2 AM daily
  sync_enabled: true

  # Monthly scrub configuration
  scrub_enabled: true
  scrub_schedule: "Sun *-*-1..7 03:00:00" # First Sunday of month at 3 AM
  scrub_percentage: 10
  scrub_older_than_days: 10

  # Thresholds before sync/scrub operations
  delete_threshold: 40 # Abort if more than X files deleted
  update_threshold: 500 # Abort if more than X files updated

  # Email notifications
  email_enabled: false # Set to true to enable email notifications
  email_on: "error" # Comma-separated: success,error
  email_short: true # Short or full output
  email_from: "snapraid@{{ inventory_hostname }}.{{ ansible_domain | default('local') }}"
  email_to: "" # Set recipient email address

  # SMTP configuration (for msmtp)
  smtp_host: "" # e.g., smtp.gmail.com
  smtp_port: 587
  smtp_tls: true
  smtp_user: "" # SMTP username
  smtp_password: "" # SMTP password (use vault!)

  # Logging
  log_retention_days: 30
  log_max_size_mb: 50

  # Content file backups
  content_backup_enabled: true
  content_backup_count: 5 # Keep last N backups

# Don't upgrade all packages on each run
# Set to true (e.g. via cli: '-e upgrade_packages=true') to upgrade all packages on the host
upgrade_packages: false

# Healthchecks, validations, tests, etc.

# Disk health validation
enable_disk_health_checks: false
prefer_native_utils: false # Use smartctl by default, set true for brand-specific tools
fail_on_unhealthy_drives: false # Warning only by default
disk_health_thresholds:
  max_temperature_celsius: 60
  max_reallocated_sectors: 50
  max_pending_sectors: 0
  max_uncorrectable_errors: 0

# Run nfs validations
validate_nfs: false
